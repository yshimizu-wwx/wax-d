exports.id=993,exports.ids=[993],exports.modules={9855:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},2673:(e,t,r)=>{Promise.resolve().then(r.bind(r,4755))},7546:(e,t,r)=>{Promise.resolve().then(r.bind(r,3828))},3828:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>C});var s=r(5344),a=r(3729),n=r(8428),i=r(5750),l=r(6506),o=r(8822),c=r(5390),d=r(2273),u=r(8120),h=r(1453);function m(){let e=(0,n.usePathname)(),[t,r]=(0,a.useState)(null),[m,f]=(0,a.useState)(!0),[x,p]=(0,a.useState)(!1),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{(0,i.ts)().then(r).finally(()=>f(!1))},[]),(0,a.useEffect)(()=>{if(!x)return;let e=e=>{b.current&&!b.current.contains(e.target)&&p(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[x]);let g=async()=>{p(!1),await (0,i.w7)()},v="/login"===e;return m?s.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-200 animate-pulse","aria-hidden":!0}):t?(0,s.jsxs)("div",{className:"relative",ref:b,children:[(0,s.jsxs)("button",{type:"button",onClick:()=>p(e=>!e),className:(0,h.cn)("flex items-center gap-2 rounded-xl px-2 py-2 md:pl-3 md:pr-3 border border-slate-200 bg-white hover:bg-slate-50 transition-colors","focus:outline-none focus:ring-2 focus:ring-agrix-forest focus:ring-offset-2"),"aria-expanded":x,"aria-haspopup":"true",children:[s.jsx("span",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-agrix-forest text-white font-bold text-sm",children:s.jsx(o.Z,{className:"h-5 w-5"})}),s.jsx("span",{className:"hidden md:inline text-sm font-bold text-slate-800 truncate max-w-[8rem]",children:t.email?.split("@")[0]||"マイページ"}),s.jsx(c.Z,{className:(0,h.cn)("h-4 w-4 text-slate-500 transition-transform",x&&"rotate-180")})]}),x&&(0,s.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-56 rounded-xl border border-slate-200 bg-white shadow-lg py-1 z-50",role:"menu",children:[(0,s.jsxs)("div",{className:"px-3 py-2 border-b border-slate-100",children:[s.jsx("p",{className:"text-xs text-slate-500",children:"ログイン中"}),s.jsx("p",{className:"text-sm font-bold text-slate-800 truncate",children:t.email})]}),(0,s.jsxs)(l.default,{href:(t.role,"/mypage"),onClick:()=>p(!1),className:"flex items-center gap-2 px-3 py-2.5 text-sm font-medium text-slate-700 hover:bg-slate-50",role:"menuitem",children:[s.jsx(d.Z,{className:"h-4 w-4 text-agrix-forest"}),"マイページ"]}),(0,s.jsxs)("button",{type:"button",onClick:g,className:"flex w-full items-center gap-2 px-3 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50",role:"menuitem",children:[s.jsx(u.Z,{className:"h-4 w-4"}),"ログアウト"]})]})]}):s.jsx(l.default,{href:v?"/":"/login",className:(0,h.cn)("inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2.5 text-sm font-bold transition-colors","bg-agrix-forest text-white hover:bg-agrix-forest-dark shadow-sm"),children:v?"トップへ":"ログイン"})}function f(){return s.jsx("header",{className:"bg-dashboard-card border-b border-dashboard-border sticky top-0 z-50 shadow-sm",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center",children:[s.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:s.jsx(l.default,{href:"/",className:"text-dashboard-text font-bold text-lg truncate hover:text-agrix-forest transition-colors flex items-center gap-1.5",children:s.jsx("span",{children:"Wayfinder AgriX Drone"})})}),s.jsx(m,{})]})})}var x=r(508),p=r(6135),b=r(7121),g=r(6810),v=r(7126),w=r(5794),j=r(4243),y=r(1917),N=r(1700),Z=r(5366);function k(e){let t=[{href:"admin"===e||"provider"===e?"/admin":"/",label:"ダッシュボード",icon:d.Z}];return"farmer"===e&&(t.push({href:"/case-map",label:"地図で探す",icon:x.Z}),t.push({href:"/requests",label:"作業依頼",icon:p.Z}),t.push({href:"/#applications",label:"申込履歴",icon:b.Z}),t.push({href:"/my-fields",label:"My畑",icon:g.Z})),"provider"===e&&(t.push({href:"/admin/campaigns/new",label:"案件作成",icon:v.Z}),t.push({href:"/provider/calendar",label:"カレンダー",icon:w.Z}),t.push({href:"/provider/reports/new",label:"実績報告",icon:b.Z}),t.push({href:"/provider/billings",label:"請求管理",icon:j.Z}),t.push({href:"/admin/masters",label:"マスタ",icon:y.Z}),t.push({href:"/admin/users",label:"紐付き農家",icon:N.Z})),"admin"===e&&(t.push({href:"/admin/users",label:"ユーザー承認",icon:Z.Z}),t.push({href:"/admin/masters",label:"マスタ",icon:y.Z})),t}function P({user:e,className:t}){let r=(0,n.usePathname)(),a=k(e.role);return s.jsx("aside",{className:(0,h.cn)("hidden md:flex flex-col w-64 shrink-0 bg-agrix-forest border-r border-white/10",t),children:s.jsx("nav",{className:"flex-1 p-3 pt-5 space-y-1 overflow-y-auto",children:a.map(e=>{let t=e.icon,a=r===e.href||"/"!==e.href&&r.startsWith(e.href);return(0,s.jsxs)(l.default,{href:e.href,className:(0,h.cn)("flex items-center gap-3 rounded-xl px-3 py-3 text-sm font-bold transition-colors",a?"bg-white/20 text-white shadow-inner":"text-white/90 hover:bg-white/10 hover:text-white"),children:[s.jsx(t,{className:"h-5 w-5 shrink-0"}),e.label]},e.href)})})})}function I({user:e,className:t}){let r=(0,n.usePathname)(),a=k(e.role).slice(0,5);return s.jsx("nav",{className:(0,h.cn)("fixed bottom-0 left-0 right-0 z-40 md:hidden border-t border-white/10 bg-agrix-forest safe-area-pb",t),children:s.jsx("div",{className:"flex items-center justify-around h-16 safe-area-pb",children:a.map(e=>{let t=e.icon,a=r===e.href||"/"!==e.href&&r.startsWith(e.href);return(0,s.jsxs)(l.default,{href:e.href,className:(0,h.cn)("flex flex-col items-center justify-center gap-1 flex-1 min-w-0 py-3 text-xs font-bold transition-colors min-h-[44px]",a?"text-white bg-white/20":"text-white/80 hover:text-white hover:bg-white/10"),children:[s.jsx(t,{className:(0,h.cn)("h-6 w-6 shrink-0",a&&"stroke-[2.5]")}),s.jsx("span",{className:"truncate max-w-[4.5rem]",children:e.label})]},e.href)})})})}let O=["/login","/auth"];function C({children:e}){let t=(0,n.usePathname)(),[r,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(0,i.ts)().then(l).finally(()=>c(!1))},[]);let d=O.some(e=>t===e||t.startsWith(e+"/")),u=!d&&!!r;return d?s.jsx(s.Fragment,{children:e}):(0,s.jsxs)("div",{className:(0,h.cn)("min-h-screen",!d&&"dashboard-app bg-dashboard-bg"),children:[s.jsx(f,{}),(0,s.jsxs)("div",{className:"flex min-h-[calc(100vh-4rem)]",children:[u&&r&&s.jsx(P,{user:r}),s.jsx("main",{className:(0,h.cn)("relative z-0 flex-1 w-full min-h-[calc(100vh-4rem)] overflow-auto",u&&"pb-20 md:pb-0 md:px-6 md:py-6"),children:e})]}),u&&r&&s.jsx(I,{user:r})]})}},5750:(e,t,r)=>{"use strict";r.d(t,{Lj:()=>i,gQ:()=>l,ts:()=>a,w7:()=>n});var s=r(8704);async function a(){try{let{data:{session:e}}=await s.O.auth.getSession();if(!e?.user?.email)return null;let{data:t,error:r}=await s.O.from("users").select("*").eq("email",e.user.email).single();if(r||!t)return null;return{id:t.id,email:t.email??"",role:t.role,name:t.name??"",phone:t.phone??"",status:t.status??"",address:t.address??void 0,lat:t.lat??void 0,lng:t.lng??void 0,associated_provider_id:t.associated_provider_id??void 0,invitation_code:t.invitation_code??void 0}}catch(e){return console.error("Error getting current user:",e),null}}async function n(){await s.O.auth.signOut(),window.location.href="/login"}async function i(e){try{let{data:{session:t}}=await s.O.auth.getSession();if(!t?.user?.email)return{success:!1,error:"ログインしていません"};let{error:r}=await s.O.from("users").update({...void 0!==e.name&&{name:e.name},...void 0!==e.phone&&{phone:e.phone},...void 0!==e.address&&{address:e.address}}).eq("email",t.user.email);if(r)return{success:!1,error:r.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function l(e){try{let{error:t}=await s.O.auth.updateUser({password:e});if(t)return{success:!1,error:t.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}},8704:(e,t,r)=>{"use strict";r.d(t,{O:()=>s});let s=(0,r(5645).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5dmllb3J3bnl4eGZ5Z2Joem55Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MjY1OTUsImV4cCI6MjA4NjQwMjU5NX0.-alPp1Cr1J2yoKcdaln4LMbOPjaGCb4wRjURGhibLPk")},1453:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(6815),a=r(9377);function n(...e){return(0,a.m6)((0,s.W)(e))}},2485:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(5036);let a=(0,r(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\components\AppLayout.tsx`),{__esModule:n,$$typeof:i}=a,l=a.default;function o({children:e}){return s.jsx(l,{children:e})}},1342:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,metadata:()=>c});var s=r(5036),a=r(2574),n=r.n(a),i=r(2255),l=r.n(i);r(5023);var o=r(7171);let c={title:"Wayfinder AgriX Drone - ドローンあいのり予約",description:"Wayfinder AgriX Drone - 農家と業者をつなぐ農作業予約プラットフォーム"};function d({children:e}){return s.jsx("html",{lang:"ja",className:"dark",children:(0,s.jsxs)("body",{className:`${l().variable} ${n().variable} font-sans antialiased tracking-tight`,children:[e,s.jsx(o.x7,{position:"top-center",richColors:!0,closeButton:!0})]})})}},3881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(337);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};