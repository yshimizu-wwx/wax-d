"use strict";(()=>{var e={};e.id=476,e.ids=[476],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4068:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>v});var a={};r.r(a),r.d(a,{GET:()=>l});var i=r(5419),o=r(9108),n=r(9678),s=r(8070),c=r(2509);async function l(e){let t=new URL(e.url),r=t.searchParams.get("code");if(r){let e=await (0,c.e)(),{data:a,error:i}=await e.auth.exchangeCodeForSession(r);if(!i&&a.user){let{data:r}=await e.from("users").select("role, id, invitation_code, associated_provider_id").eq("email",a.user.email).single();if(r){let i="provider"===r.role?"under_review":"active";if(await e.from("users").update({status:i}).eq("email",a.user.email),"farmer"===r.role&&r.invitation_code){let{data:t}=await e.from("users").select("id").eq("invitation_code",r.invitation_code).eq("role","provider").single();t&&t.id!==r.associated_provider_id&&await e.from("farmer_providers").insert({farmer_id:r.id,provider_id:t.id,status:"active",created_at:new Date().toISOString()})}return"provider"===r.role?s.Z.redirect(new URL("/auth/pending-approval",t.origin)):s.Z.redirect(new URL("/auth/verified",t.origin))}}}return s.Z.redirect(new URL("/login",t.origin))}let u=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/(auth)/auth/callback/route",pathname:"/auth/callback",filename:"route",bundlePath:"app/(auth)/auth/callback/route"},resolvedPagePath:"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\(auth)\\auth\\callback\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:m,headerHooks:h,staticGenerationBailout:v}=u,g="/(auth)/auth/callback/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}},2509:(e,t,r)=>{r.d(t,{e:()=>o});var a=r(6496),i=r(7439);async function o(){let e=await (0,i.cookies)();return(0,a.createServerClient)("https://ayvieorwnyxxfygbhzny.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5dmllb3J3bnl4eGZ5Z2Joem55Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MjY1OTUsImV4cCI6MjA4NjQwMjU5NX0.-alPp1Cr1J2yoKcdaln4LMbOPjaGCb4wRjURGhibLPk",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:a})=>{r?e.set(t,r,a):e.delete(t)})}catch{}}}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,744],()=>r(4068));module.exports=a})();