(()=>{var e={};e.id=210,e.ids=[210],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},826:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>d,routeModule:()=>m,tree:()=>c});var r=s(482),a=s(9108),n=s(2563),l=s.n(n),i=s(8300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let c=["",{children:["admin",{children:["masters",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6722)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\admin\\masters\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,7858)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\admin\\masters\\page.tsx"],x="/admin/masters/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/masters/page",pathname:"/admin/masters",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9855:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2583,23)),Promise.resolve().then(s.t.bind(s,6840,23)),Promise.resolve().then(s.t.bind(s,8771,23)),Promise.resolve().then(s.t.bind(s,3225,23)),Promise.resolve().then(s.t.bind(s,9295,23)),Promise.resolve().then(s.t.bind(s,3982,23))},7125:(e,t,s)=>{Promise.resolve().then(s.bind(s,4755)),Promise.resolve().then(s.bind(s,2041))},3135:(e,t,s)=>{Promise.resolve().then(s.bind(s,4151))},2739:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(9224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4151:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var r=s(5344),a=s(3729),n=s(1917),l=s(9224);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,l.Z)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),o=(0,l.Z)("ListTree",[["path",{d:"M21 12h-8",key:"1bmf0i"}],["path",{d:"M21 6H8",key:"1pqkrb"}],["path",{d:"M21 18h-8",key:"1tm79t"}],["path",{d:"M3 6v4c0 1.1.9 2 2 2h3",key:"1ywdgy"}],["path",{d:"M3 10v6c0 1.1.9 2 2 2h3",key:"2wc746"}]]),c=(0,l.Z)("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);var d=s(2739);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,l.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),u=(0,l.Z)("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),m=(0,l.Z)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),p=(0,l.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var h=s(5750),g=s(8704);async function f(e,t){let s=g.O.from("masters").select("*").eq("type",e).order("name",{ascending:!0});t&&(s=s.or(`provider_id.eq.${t},provider_id.is.null`));let{data:r,error:a}=await s;return a?(console.error("Error fetching masters:",a),[]):r||[]}async function b(e,t,s,r){try{let a=`M_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,{error:n}=await g.O.from("masters").insert({id:a,provider_id:s,type:e,name:t.trim(),parent_id:r||null,status:"active"});if(n)return{success:!1,error:n.message};return{success:!0,id:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function y(e,t){try{let{error:s}=await g.O.from("masters").update(t).eq("id",e);if(s)return{success:!1,error:s.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function v(e){return y(e,{status:"inactive"})}async function j(e){return y(e,{status:"active"})}var w=s(4755);let N=[{key:"crop",label:"品目",icon:r.jsx(n.Z,{className:"w-4 h-4"})},{key:"task_category",label:"作業種別",icon:r.jsx(i,{className:"w-4 h-4"})},{key:"task_detail",label:"作業詳細",icon:r.jsx(o,{className:"w-4 h-4"})},{key:"pesticide",label:"農薬",icon:r.jsx(c,{className:"w-4 h-4"})}];function k(){let[e,t]=(0,a.useState)(null),[s,l]=(0,a.useState)(!0),[i,o]=(0,a.useState)("crop"),[c,g]=(0,a.useState)([]),[k,P]=(0,a.useState)(!1),[_,Z]=(0,a.useState)(null),[C,q]=(0,a.useState)(""),[M,S]=(0,a.useState)(!1),[A,E]=(0,a.useState)(""),[L,z]=(0,a.useState)(!1),D=e?.role==="provider"?e.id:(e?.role,null),O=async()=>{void 0!==D&&(P(!0),g(await f(i,D)),P(!1))};(0,a.useEffect)(()=>{(0,h.ts)().then(e=>{t(e),l(!1)})},[]),(0,a.useEffect)(()=>{e&&O()},[e,i]);let $=async()=>{let e=A.trim();if(!e){w.toast.error("名称を入力してください");return}z(!0);let t=await b(i,e,D??null,void 0);z(!1),t.success?(w.toast.success("追加しました"),E(""),S(!1),O()):w.toast.error(t.error||"追加に失敗しました")},W=e=>{Z(e.id),q(e.name)},X=async()=>{if(!_)return;let e=C.trim();if(!e){w.toast.error("名称を入力してください");return}z(!0);let t=await y(_,{name:e});z(!1),t.success?(w.toast.success("更新しました"),Z(null),O()):w.toast.error(t.error||"更新に失敗しました")},U=async e=>{z(!0);let t="active"===e.status?await v(e.id):await j(e.id);z(!1),t.success?(w.toast.success("active"===e.status?"無効にしました":"有効にしました"),O()):w.toast.error(t.error||"操作に失敗しました")};if(s)return r.jsx("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[r.jsx(d.Z,{className:"w-10 h-10 text-green-600 animate-spin"}),r.jsx("p",{className:"text-slate-600 font-medium",children:"読み込み中..."})]})});if(!e||"admin"!==e.role&&"provider"!==e.role)return r.jsx("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:r.jsx("div",{className:"bg-white p-8 rounded-2xl shadow border border-slate-200 text-center",children:r.jsx("p",{className:"text-slate-600",children:"この画面を利用する権限がありません。"})})});let F=N.find(e=>e.key===i);return r.jsx("main",{className:"min-h-screen bg-slate-50",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h1",{className:"text-2xl font-black text-slate-800 flex items-center gap-2",children:[r.jsx(n.Z,{className:"w-7 h-7 text-green-600"}),"マスタ管理"]}),"provider"===e.role&&r.jsx("p",{className:"text-sm text-slate-500",children:"自社マスタ＋共通マスタを表示"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[r.jsx("div",{className:"flex border-b border-slate-200 overflow-x-auto",children:N.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>{o(e.key),Z(null),S(!1)},className:`flex items-center gap-2 px-5 py-4 text-sm font-bold whitespace-nowrap transition-colors ${i===e.key?"text-green-600 border-b-2 border-green-600 bg-green-50/50":"text-slate-500 hover:bg-slate-50"}`,children:[e.icon,e.label]},e.key))}),r.jsx("div",{className:"p-4",children:k?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(d.Z,{className:"w-8 h-8 text-slate-400 animate-spin"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h2",{className:"font-bold text-slate-700 flex items-center gap-2",children:[F?.icon,F?.label,"一覧"]}),(0,r.jsxs)("button",{type:"button",onClick:()=>S(!0),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-xl text-sm font-bold hover:bg-green-500 transition-colors",children:[r.jsx(x,{className:"w-4 h-4"}),"追加"]})]}),M&&(0,r.jsxs)("div",{className:"flex gap-2 mb-4 p-3 bg-slate-50 rounded-xl border border-slate-200",children:[r.jsx("input",{type:"text",value:A,onChange:e=>E(e.target.value),placeholder:"名称を入力",className:"flex-1 px-4 py-2 rounded-lg border border-slate-200 focus:ring-2 focus:ring-green-500 focus:border-green-500"}),(0,r.jsxs)("button",{type:"button",onClick:$,disabled:L,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-sm hover:bg-green-500 disabled:opacity-50 flex items-center gap-2",children:[L?r.jsx(d.Z,{className:"w-4 h-4 animate-spin"}):r.jsx(x,{className:"w-4 h-4"}),"登録"]}),r.jsx("button",{type:"button",onClick:()=>{S(!1),E("")},className:"px-4 py-2 rounded-lg border border-slate-200 text-slate-600 font-bold text-sm hover:bg-slate-100",children:"キャンセル"})]}),r.jsx("ul",{className:"divide-y divide-slate-100",children:0===c.length?r.jsx("li",{className:"py-8 text-center text-slate-500 text-sm",children:"データがありません。追加ボタンで登録してください。"}):c.map(e=>r.jsx("li",{className:`flex items-center justify-between py-3 px-2 rounded-lg ${"inactive"===e.status?"bg-slate-50 text-slate-400":""}`,children:_===e.id?(0,r.jsxs)("div",{className:"flex-1 flex gap-2",children:[r.jsx("input",{type:"text",value:C,onChange:e=>q(e.target.value),className:"flex-1 px-3 py-2 rounded-lg border border-slate-200 focus:ring-2 focus:ring-green-500"}),(0,r.jsxs)("button",{type:"button",onClick:X,disabled:L,className:"text-green-600 font-bold text-sm hover:underline disabled:opacity-50 flex items-center gap-1",children:[L?r.jsx(d.Z,{className:"w-4 h-4 animate-spin"}):null,"保存"]}),r.jsx("button",{type:"button",onClick:()=>Z(null),className:"text-slate-500 text-sm hover:underline",children:"キャンセル"})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("span",{className:"font-medium",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>W(e),className:"p-2 text-slate-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"編集",children:r.jsx(u,{className:"w-4 h-4"})}),r.jsx("button",{type:"button",onClick:()=>U(e),disabled:L,className:"p-2 rounded-lg transition-colors disabled:opacity-50",title:"active"===e.status?"無効にする":"有効にする",children:"active"===e.status?r.jsx(m,{className:"w-4 h-4 text-amber-600 hover:bg-amber-50"}):r.jsx(p,{className:"w-4 h-4 text-green-600 hover:bg-green-50"})})]})]})},e.id))})]})})]})]})})}},2041:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5344),a=s(3729),n=s(6506),l=s(8428),i=s(2273),o=s(7121),c=s(4243),d=s(1917),x=s(9895),u=s(8120),m=s(5750);function p(){var e;let t=(0,l.usePathname)(),[s,p]=(0,a.useState)(null),[h,g]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(0,m.ts)().then(p).finally(()=>g(!1))},[]);let f=async()=>{await (0,m.w7)()},b="/login"===t;return r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center",children:[(0,r.jsxs)(n.default,{href:"/",className:"text-xl font-black text-slate-800 tracking-tight hover:text-green-600 transition-colors",children:[r.jsx("span",{className:"text-green-600",children:"\uD83C\uDF3E"})," Wayfinder AgriX"]}),r.jsx("nav",{className:"flex items-center gap-3",children:h?r.jsx("span",{className:"text-slate-400 text-sm",children:"..."}):s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.default,{href:"admin"===(e=s.role)||"provider"===e?"/admin":"/",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(i.Z,{className:"w-4 h-4"}),"マイページ"]}),"farmer"===s.role&&(0,r.jsxs)(n.default,{href:"/#applications",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(o.Z,{className:"w-4 h-4"}),"申込履歴"]}),"provider"===s.role&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.default,{href:"/provider/reports/new",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(o.Z,{className:"w-4 h-4"}),"実績報告"]}),(0,r.jsxs)(n.default,{href:"/provider/billings",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(c.Z,{className:"w-4 h-4"}),"請求"]})]}),("admin"===s.role||"provider"===s.role)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.default,{href:"/admin/masters",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(d.Z,{className:"w-4 h-4"}),"マスタ"]}),(0,r.jsxs)(n.default,{href:"/admin/users",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(x.Z,{className:"w-4 h-4"}),"ユーザー"]})]}),(0,r.jsxs)("button",{type:"button",onClick:f,className:"text-sm font-bold text-slate-700 hover:text-red-600 transition-colors px-3 py-2 rounded-lg hover:bg-red-50 border border-slate-200 hover:border-red-200 flex items-center gap-1",children:[r.jsx(u.Z,{className:"w-4 h-4"}),"ログアウト"]})]}):r.jsx(n.default,{href:b?"/":"/login",className:"text-sm font-bold text-white bg-green-600 hover:bg-green-500 px-4 py-2 rounded-lg transition-colors",children:b?"トップへ":"ログイン"})})]})})}},5750:(e,t,s)=>{"use strict";s.d(t,{ts:()=>a,w7:()=>n});var r=s(8704);async function a(){try{let{data:{session:e}}=await r.O.auth.getSession();if(!e)return null;let{data:t,error:s}=await r.O.from("users").select("*").eq("email",e.user.email).single();if(s||!t)return null;return t}catch(e){return console.error("Error getting current user:",e),null}}async function n(){await r.O.auth.signOut(),window.location.href="/login"}},8704:(e,t,s)=>{"use strict";s.d(t,{O:()=>r});let r=(0,s(3974).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","sb_publishable_saY21TLJVLBNk5lg53j5Pg_PW9RAlEr")},6722:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>l});let r=(0,s(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\app\admin\masters\page.tsx`),{__esModule:a,$$typeof:n}=r,l=r.default},7858:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p,metadata:()=>m});var r=s(5036),a=s(2574),n=s.n(a),l=s(2255),i=s.n(l);s(5023);let o=(0,s(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\components\Header.tsx`),{__esModule:c,$$typeof:d}=o,x=o.default;var u=s(7171);let m={title:"Wayfinder AgriX - ドローンあいのり予約",description:"農家と業者をつなぐ農作業予約プラットフォーム"};function p({children:e}){return r.jsx("html",{lang:"ja",children:(0,r.jsxs)("body",{className:`${n().variable} ${i().variable} font-sans antialiased`,children:[r.jsx(x,{}),e,r.jsx(u.x7,{position:"top-center",richColors:!0,closeButton:!0})]})})}},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(337);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,45,337],()=>s(826));module.exports=r})();