(()=>{var e={};e.id=3,e.ids=[3],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},9375:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>d.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>c});var a=t(482),r=t(9108),l=t(2563),d=t.n(l),n=t(8300),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);t.d(s,i);let c=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5557)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\admin\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,7858)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\admin\\page.tsx"],x="/admin/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6343:(e,s,t)=>{Promise.resolve().then(t.bind(t,7300))},5299:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},1700:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},5794:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},2739:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5366:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(9224).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},7300:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(5344),r=t(3729),l=t(6506),d=t(2739),n=t(2273),i=t(5366),c=t(5299),o=t(7121),x=t(9895),m=t(5794);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,t(9224).Z)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var p=t(1917),u=t(1700),g=t(5750),f=t(8704),b=t(8732),j=t(4755);function v(){let[e,s]=(0,r.useState)(null),[t,v]=(0,r.useState)(!0),[N,w]=(0,r.useState)(0),[y,_]=(0,r.useState)([]),[k,Z]=(0,r.useState)(0),[q,P]=(0,r.useState)(0);return((0,r.useEffect)(()=>{(0,g.ts)().then(e=>{s(e),v(!1)})},[]),(0,r.useEffect)(()=>{e&&("admin"===e.role&&(f.O.from("users").select("id",{count:"exact",head:!0}).eq("status","pending").then(({count:e})=>w(e??0)),f.O.from("projects").select("id",{count:"exact",head:!0}).eq("status","open").then(({count:e})=>Z(e??0))),"provider"===e.role&&f.O.from("projects").select("id, campaign_title, location, final_date, status, is_closed").eq("provider_id",e.id).in("status",["open","closed","applied"]).order("start_date",{ascending:!0}).limit(10).then(({data:e})=>{if(!e?.length){_([]);return}let s=e.map(e=>e.id);f.O.from("bookings").select("campaign_id, confirmed_date").in("campaign_id",s).neq("status","canceled").then(({data:s})=>{let t=new Map;(s||[]).forEach(e=>{let s=e.campaign_id,a=t.get(s)||{confirmed_date:"",count:0};a.count+=1,e.confirmed_date&&(a.confirmed_date=e.confirmed_date),t.set(s,a)}),_(e.map(e=>{let s=t.get(e.id)||{confirmed_date:"",count:0};return{id:e.id,campaign_title:e.campaign_title||e.location||"案件",location:e.location||"",confirmed_date:s.confirmed_date,final_date:e.final_date||"",booking_count:s.count,status:e.status??"",is_closed:e.is_closed??!1}}).slice(0,5))})}))},[e,q]),t)?a.jsx("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[a.jsx(d.Z,{className:"w-10 h-10 text-green-600 animate-spin"}),a.jsx("p",{className:"text-slate-600 font-medium",children:"読み込み中..."})]})}):e&&("admin"===e.role||"provider"===e.role)?"admin"===e.role?a.jsx("main",{className:"min-h-screen bg-slate-50",children:(0,a.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[(0,a.jsxs)("h1",{className:"text-2xl font-black text-slate-800 flex items-center gap-2 mb-6",children:[a.jsx(n.Z,{className:"w-7 h-7 text-green-600"}),"Platform Admin"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:[(0,a.jsxs)(l.default,{href:"/admin/users",className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm hover:shadow-md hover:border-green-200 transition-all flex items-center justify-between group",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 rounded-xl bg-amber-50",children:a.jsx(i.Z,{className:"w-6 h-6 text-amber-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-bold text-slate-500",children:"承認待ちユーザー"}),a.jsx("p",{className:"text-2xl font-black text-slate-800",children:N})]})]}),a.jsx(c.Z,{className:"w-5 h-5 text-slate-300 group-hover:text-green-600"})]}),a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 rounded-xl bg-green-50",children:a.jsx(o.Z,{className:"w-6 h-6 text-green-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-bold text-slate-500",children:"募集中案件数"}),a.jsx("p",{className:"text-2xl font-black text-slate-800",children:k})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-slate-100 flex items-center gap-2",children:[a.jsx(x.Z,{className:"w-5 h-5 text-slate-500"}),a.jsx("h2",{className:"font-bold text-slate-700",children:"クイックリンク"})]}),a.jsx("ul",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:a.jsx("li",{children:(0,a.jsxs)(l.default,{href:"/admin/users",className:"flex items-center gap-3 p-3 rounded-xl border border-slate-100 hover:bg-slate-50 hover:border-green-200 transition-colors",children:[a.jsx(i.Z,{className:"w-5 h-5 text-amber-600"}),a.jsx("span",{className:"font-bold text-slate-700",children:"ユーザー承認管理"})]})})})]})]})}):a.jsx("main",{className:"min-h-screen bg-slate-50",children:(0,a.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[(0,a.jsxs)("h1",{className:"text-2xl font-black text-slate-800 flex items-center gap-2 mb-6",children:[a.jsx(n.Z,{className:"w-7 h-7 text-green-600"}),"ダッシュボード"]}),(0,a.jsxs)("section",{className:"mb-8",children:[(0,a.jsxs)("h2",{className:"font-bold text-slate-700 flex items-center gap-2 mb-4",children:[a.jsx(m.Z,{className:"w-5 h-5 text-green-600"}),"直近の作業予定"]}),a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:0===y.length?a.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"直近の案件はありません。新規案件を作成してください。"}):a.jsx("ul",{className:"divide-y divide-slate-100",children:y.map(e=>(0,a.jsxs)("li",{className:"p-4 flex items-center justify-between gap-3 flex-wrap",children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"font-bold text-slate-800",children:e.campaign_title||e.location}),(0,a.jsxs)("p",{className:"text-sm text-slate-500",children:[e.confirmed_date||e.final_date?new Date(e.confirmed_date||e.final_date).toLocaleDateString("ja-JP"):"日付未確定"," \xb7 ","申込 ",e.booking_count," 件",e.is_closed||"closed"===e.status?" \xb7 締切済":""]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[!e.is_closed&&("open"===e.status||"applied"===e.status)&&a.jsx("button",{type:"button",onClick:async()=>{let s=await (0,b.dm)(e.id);s.success?(j.toast.success("募集を締め切りました"),P(e=>e+1)):j.toast.error(s.error??"締切に失敗しました")},className:"px-3 py-1.5 rounded-lg bg-amber-100 text-amber-800 text-sm font-bold hover:bg-amber-200 border border-amber-300",children:"募集締切"}),(0,a.jsxs)(l.default,{href:"/provider/calendar",className:"text-sm font-bold text-green-600 hover:underline flex items-center gap-1",children:["カレンダー ",a.jsx(c.Z,{className:"w-4 h-4"})]})]})]},e.id))})})]}),(0,a.jsxs)("section",{children:[a.jsx("h2",{className:"font-bold text-slate-700 flex items-center gap-2 mb-4",children:"メニュー"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)(l.default,{href:"/admin/campaigns/new",className:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-md hover:border-green-200 transition-all",children:[a.jsx("div",{className:"p-3 rounded-xl bg-green-50",children:a.jsx(h,{className:"w-6 h-6 text-green-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-bold text-slate-800",children:"案件を作成"}),a.jsx("p",{className:"text-sm text-slate-500",children:"新規募集を開始"})]}),a.jsx(c.Z,{className:"w-5 h-5 text-slate-300 ml-auto"})]}),(0,a.jsxs)(l.default,{href:"/provider/calendar",className:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-md hover:border-green-200 transition-all",children:[a.jsx("div",{className:"p-3 rounded-xl bg-blue-50",children:a.jsx(m.Z,{className:"w-6 h-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-bold text-slate-800",children:"作業カレンダー"}),a.jsx("p",{className:"text-sm text-slate-500",children:"予定の確認・管理"})]}),a.jsx(c.Z,{className:"w-5 h-5 text-slate-300 ml-auto"})]}),(0,a.jsxs)(l.default,{href:"/admin/masters",className:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-md hover:border-green-200 transition-all",children:[a.jsx("div",{className:"p-3 rounded-xl bg-slate-100",children:a.jsx(p.Z,{className:"w-6 h-6 text-slate-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-bold text-slate-800",children:"マスタ管理"}),a.jsx("p",{className:"text-sm text-slate-500",children:"品目・作業種別・農薬"})]}),a.jsx(c.Z,{className:"w-5 h-5 text-slate-300 ml-auto"})]}),(0,a.jsxs)(l.default,{href:"/admin/users",className:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-md hover:border-green-200 transition-all",children:[a.jsx("div",{className:"p-3 rounded-xl bg-amber-50",children:a.jsx(u.Z,{className:"w-6 h-6 text-amber-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-bold text-slate-800",children:"紐付き農家一覧"}),a.jsx("p",{className:"text-sm text-slate-500",children:"自分に紐付いている農家"})]}),a.jsx(c.Z,{className:"w-5 h-5 text-slate-300 ml-auto"})]}),(0,a.jsxs)(l.default,{href:"/provider/reports/new",className:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-md hover:border-green-200 transition-all",children:[a.jsx("div",{className:"p-3 rounded-xl bg-purple-50",children:a.jsx(o.Z,{className:"w-6 h-6 text-purple-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-bold text-slate-800",children:"実績報告"}),a.jsx("p",{className:"text-sm text-slate-500",children:"作業完了の報告"})]}),a.jsx(c.Z,{className:"w-5 h-5 text-slate-300 ml-auto"})]})]})]})]})}):a.jsx("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:a.jsx("div",{className:"bg-white p-8 rounded-2xl shadow border border-slate-200 text-center",children:a.jsx("p",{className:"text-slate-600",children:"この画面を利用する権限がありません。"})})})}},5557:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>r,default:()=>d});let a=(0,t(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\app\admin\page.tsx`),{__esModule:r,$$typeof:l}=a,d=a.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[638,45,337,968,103],()=>t(9375));module.exports=a})();