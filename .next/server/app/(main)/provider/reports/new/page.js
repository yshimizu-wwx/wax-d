(()=>{var e={};e.id=183,e.ids=[183],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},1005:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>d.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>o});var r=a(482),s=a(9108),i=a(2563),d=a.n(i),l=a(8300),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);a.d(t,n);let o=["",{children:["(main)",{children:["provider",{children:["reports",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,3633)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\(main)\\provider\\reports\\new\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,2485)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\(main)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,1342)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\(main)\\provider\\reports\\new\\page.tsx"],p="/(main)/provider/reports/new/page",u={require:a,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(main)/provider/reports/new/page",pathname:"/provider/reports/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},8663:(e,t,a)=>{Promise.resolve().then(a.bind(a,956))},5390:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},1532:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},8134:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]])},7121:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},9388:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]])},2273:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},9798:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]])},8120:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},508:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},1917:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},4243:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]])},6135:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},3746:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6810:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]])},5366:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(9224).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},6506:(e,t,a)=>{"use strict";a.d(t,{default:()=>s.a});var r=a(1476),s=a.n(r)},956:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var r=a(5344),s=a(3729),i=a(8428),d=a(6506),l=a(1532),n=a(8134);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,a(9224).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var c=a(508),p=a(5750),u=a(8704),x=a(3673);function h(){let e=(0,i.useRouter)(),[t,a]=(0,s.useState)(null),[h,m]=(0,s.useState)([]),[f,g]=(0,s.useState)(!0),[y,b]=(0,s.useState)(!1),[v,k]=(0,s.useState)(null),[w,j]=(0,s.useState)(null),[N,Z]=(0,s.useState)(""),[_,q]=(0,s.useState)(0),[M,P]=(0,s.useState)(null),[C,S]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{let t=await (0,p.ts)();if(!t||"provider"!==t.role){e.replace("/login");return}a(t);let{data:r}=await u.O.from("campaigns").select("id").eq("provider_id",t.id),s=(r||[]).map(e=>e.id);if(0===s.length){g(!1);return}let{data:i,error:d}=await u.O.from("bookings").select("id, campaign_id, farmer_id, area_10r, work_status").in("campaign_id",s).eq("work_status","pending").neq("status","canceled");if(d){k("申込一覧の取得に失敗しました"),g(!1);return}let l=i||[];if(l.length>0){let{data:e}=await u.O.from("campaigns").select("id, campaign_title, location, final_unit_price, base_price").in("id",[...new Set(l.map(e=>e.campaign_id))]),t=new Map((e||[]).map(e=>[e.id,e]));l.forEach(e=>{e.projects=t.get(e.campaign_id)})}m(l),l.length>0&&!N&&(Z(l[0].id),q(Number(l[0].area_10r)||0)),g(!1)})()},[e]);let A=async e=>{if(e.preventDefault(),k(null),j(null),!N||_<=0){k("申込を選択し、実績面積を入力してください");return}b(!0);try{let e,t;M&&(t=M.type||"image/jpeg",e=await new Promise((e,t)=>{let a=new FileReader;a.onload=()=>{let t=a.result,r=t.indexOf(",")>=0?t.split(",")[1]:t;e(r||"")},a.onerror=t,a.readAsDataURL(M)}));let a=await fetch("/api/provider/reports/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookingId:N,actualArea10r:Number(_),imageBase64:e,mimeType:t,gps:C??void 0})}),r=await a.json();if(!a.ok){k(r.message||"登録に失敗しました");return}j(`実績を報告しました。確定金額: \xa5${(r.finalAmount??0).toLocaleString()}`),m(e=>e.filter(e=>e.id!==N)),Z(""),q(0),P(null),S(null)}catch(e){k("送信に失敗しました")}finally{b(!1)}};return f?r.jsx("main",{className:"min-h-full flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-agrix-forest"})}):r.jsx("main",{className:"min-h-full",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,r.jsxs)(d.default,{href:"/admin/campaigns",className:"p-2 rounded-lg border border-dashboard-border hover:bg-dashboard-card flex items-center gap-2 text-dashboard-muted",children:[r.jsx(l.Z,{className:"w-5 h-5"}),"戻る"]}),(0,r.jsxs)("h1",{className:"text-2xl font-bold text-dashboard-text flex items-center gap-2",children:[r.jsx(n.Z,{className:"w-7 h-7 text-agrix-forest"}),"実績報告"]})]}),0===h.length?r.jsx(x.Zb,{children:(0,r.jsxs)(x.aY,{className:"p-8 text-center text-dashboard-muted",children:[r.jsx("p",{children:"報告可能な申込（作業未完了）がありません。"}),r.jsx(d.default,{href:"/admin/campaigns",className:"mt-4 inline-block text-agrix-forest font-medium hover:underline",children:"案件一覧へ"})]})}):r.jsx(x.Zb,{className:"overflow-hidden",children:(0,r.jsxs)("form",{onSubmit:A,children:[(0,r.jsxs)(x.aY,{className:"p-6 space-y-6",children:[v&&r.jsx("div",{className:"p-4 bg-destructive/10 border border-destructive/30 rounded-xl text-destructive text-sm font-medium",children:v}),w&&r.jsx("div",{className:"p-4 bg-agrix-forest/10 border border-agrix-forest/30 rounded-xl text-agrix-forest text-sm font-medium",children:w}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-dashboard-text mb-2",children:"対象申込"}),(0,r.jsxs)("select",{value:N,onChange:e=>{Z(e.target.value);let t=h.find(t=>t.id===e.target.value);t&&q(Number(t.area_10r)||0)},className:"w-full p-3 bg-dashboard-bg border border-dashboard-border rounded-xl focus:ring-2 focus:ring-agrix-forest",required:!0,children:[r.jsx("option",{value:"",children:"選択してください"}),h.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.projects?.location??e.campaign_id," — 申込ID: ",e.id,"（",e.area_10r," 反）"]},e.id))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-dashboard-text mb-2",children:"実績面積（反）"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:_||"",onChange:e=>q(Number(e.target.value)||0),className:"w-full p-3 bg-dashboard-bg border border-dashboard-border rounded-xl focus:ring-2 focus:ring-agrix-forest",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-bold text-dashboard-text mb-2 flex items-center gap-2",children:[r.jsx(o,{className:"w-4 h-4"}),"証跡写真（任意）"]}),r.jsx("input",{type:"file",accept:"image/*",onChange:e=>P(e.target.files?.[0]??null),className:"w-full text-sm text-dashboard-muted file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-agrix-forest/10 file:text-agrix-forest"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-bold text-dashboard-text mb-2 flex items-center gap-2",children:[r.jsx(c.Z,{className:"w-4 h-4"}),"GPS（任意）"]}),r.jsx("button",{type:"button",onClick:()=>{if(!navigator.geolocation){k("お使いの環境ではGPSを利用できません");return}navigator.geolocation.getCurrentPosition(e=>S({lat:e.coords.latitude,lng:e.coords.longitude}),()=>k("位置情報の取得に失敗しました"))},className:"px-4 py-2 bg-dashboard-bg hover:bg-dashboard-border rounded-lg text-sm font-medium text-dashboard-text",children:"現在地を取得"}),C&&(0,r.jsxs)("p",{className:"mt-2 text-xs text-dashboard-muted",children:[C.lat.toFixed(6),", ",C.lng.toFixed(6)]})]})]}),r.jsx("div",{className:"px-6 py-4 bg-dashboard-bg border-t border-dashboard-border",children:r.jsx("button",{type:"submit",disabled:y,className:"w-full py-3 bg-agrix-forest text-white font-bold rounded-xl hover:bg-agrix-forest-light disabled:opacity-50 disabled:cursor-not-allowed",children:y?"送信中...":"実績を報告する"})})]})})]})})}},3673:(e,t,a)=>{"use strict";a.d(t,{Ol:()=>l,SZ:()=>o,Zb:()=>d,aY:()=>c,ll:()=>n});var r=a(5344),s=a(3729),i=a(1453);let d=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("rounded-xl border border-border bg-card text-card-foreground shadow-sm transition-all duration-200 hover:shadow-md",e),...t}));d.displayName="Card";let l=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let n=s.forwardRef(({className:e,...t},a)=>r.jsx("h3",{ref:a,className:(0,i.cn)("text-lg font-bold leading-none tracking-tight text-card-foreground",e),...t}));n.displayName="CardTitle";let o=s.forwardRef(({className:e,...t},a)=>r.jsx("p",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));o.displayName="CardDescription";let c=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},3633:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>s,default:()=>d});let r=(0,a(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\app\(main)\provider\reports\new\page.tsx`),{__esModule:s,$$typeof:i}=r,d=r.default}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638,240,337,859,804,993],()=>a(1005));module.exports=r})();