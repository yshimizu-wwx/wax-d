(()=>{var e={};e.id=626,e.ids=[626],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},6985:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var a=s(482),r=s(9108),l=s(2563),n=s.n(l),i=s(8300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1613)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\login\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,7858)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\login\\page.tsx"],u="/login/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9855:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2583,23)),Promise.resolve().then(s.t.bind(s,6840,23)),Promise.resolve().then(s.t.bind(s,8771,23)),Promise.resolve().then(s.t.bind(s,3225,23)),Promise.resolve().then(s.t.bind(s,9295,23)),Promise.resolve().then(s.t.bind(s,3982,23))},7125:(e,t,s)=>{Promise.resolve().then(s.bind(s,4755)),Promise.resolve().then(s.bind(s,2041))},1760:(e,t,s)=>{Promise.resolve().then(s.bind(s,9682))},9682:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(5344),r=s(3729),l=s(8428),n=s(8704);function i(){let e=(0,l.useRouter)(),[t,s]=(0,r.useState)(!0),[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[x,p]=(0,r.useState)({email:"",password:"",name:"",phone:"",role:"farmer",invitationCode:""}),h=async t=>{t.preventDefault(),o(!0),c(null);try{let{data:t,error:s}=await n.O.auth.signInWithPassword({email:x.email,password:x.password});if(s)throw s;let{data:a,error:r}=await n.O.from("users").select("*").eq("email",x.email).single();if(r)throw r;if("pending"===a.status){c("メール認証が完了していません。届いたメールを確認してください。"),await n.O.auth.signOut();return}if("provider"===a.role&&"under_review"===a.status){c("アカウントは審査中です。管理者による承認後、ログインが可能になります。"),await n.O.auth.signOut();return}if("suspended"===a.status||"rejected"===a.status){c("このアカウントは現在利用できません。"),await n.O.auth.signOut();return}e.refresh(),"admin"===a.role?e.push("/admin"):"provider"===a.role?e.push("/admin/campaigns"):e.push("/")}catch(e){console.error("Login error:",e),c(e.message||"ログインに失敗しました")}finally{o(!1)}},g=async e=>{e.preventDefault(),o(!0),c(null),m(null);try{let{data:e}=await n.O.from("users").select("email").eq("email",x.email).single();if(e){c("このメールアドレスは既に登録されています");return}let{data:t,error:s}=await n.O.auth.signUp({email:x.email,password:x.password,options:{emailRedirectTo:`${window.location.origin}/auth/callback`,data:{name:x.name,phone:x.phone,role:x.role,invitation_code:x.invitationCode}}});if(s)throw s;let a=("farmer"===x.role?"F":"P")+Date.now(),r="provider"===x.role?a:null;if("farmer"===x.role&&x.invitationCode){let{data:e}=await n.O.from("users").select("id").eq("invitation_code",x.invitationCode).eq("role","provider").single();e&&(r=e.id)}let{error:l}=await n.O.from("users").insert({id:a,email:x.email,role:x.role,name:x.name,phone:x.phone,status:"pending",associated_provider_id:r,invitation_code:x.invitationCode||null});if(l)throw l;m("確認メールを送信しました。メール内のリンクをクリックして登録を完了してください。"),p({email:"",password:"",name:"",phone:"",role:"farmer",invitationCode:""})}catch(e){console.error("Signup error:",e),c(e.message||"登録に失敗しました")}finally{o(!1)}};return a.jsx("main",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsxs)("h1",{className:"text-4xl font-black text-[#334155] mb-2",children:[a.jsx("span",{className:"text-[#16a34a]",children:"\uD83C\uDF3E"})," Wayfinder AgriX"]}),a.jsx("p",{className:"text-slate-500 font-medium",children:"農家と業者をつなぐプラットフォーム"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex border-b border-slate-200",children:[a.jsx("button",{onClick:()=>{s(!0),c(null),m(null)},className:`flex-1 py-4 font-bold transition-colors ${t?"bg-[#16a34a] text-white":"bg-slate-50 text-slate-600 hover:bg-slate-100"}`,children:"ログイン"}),a.jsx("button",{onClick:()=>{s(!1),c(null),m(null)},className:`flex-1 py-4 font-bold transition-colors ${t?"bg-slate-50 text-slate-600 hover:bg-slate-100":"bg-[#16a34a] text-white"}`,children:"新規登録"})]}),(0,a.jsxs)("div",{className:"p-8",children:[d&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-2xl text-red-700 text-sm font-medium",children:[a.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d]}),u&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-2xl text-green-700 text-sm font-medium",children:[a.jsx("i",{className:"fas fa-check-circle mr-2"}),u]}),t?(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"メールアドレス"}),a.jsx("input",{type:"email",value:x.email,onChange:e=>p({...x,email:e.target.value}),className:"w-full p-4 bg-slate-50 rounded-2xl border border-slate-200 outline-none focus:ring-2 focus:ring-[#16a34a]",placeholder:"example@example.com",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"パスワード"}),a.jsx("input",{type:"password",value:x.password,onChange:e=>p({...x,password:e.target.value}),className:"w-full p-4 bg-slate-50 rounded-2xl border border-slate-200 outline-none focus:ring-2 focus:ring-[#16a34a]",placeholder:"••••••••",required:!0})]}),a.jsx("button",{type:"submit",disabled:i,className:"w-full bg-[#16a34a] text-white py-4 rounded-2xl font-black shadow-sm hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:i?(0,a.jsxs)(a.Fragment,{children:[a.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"ログイン中..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("i",{className:"fas fa-sign-in-alt mr-2"}),"ログイン"]})})]}):(0,a.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"ユーザー種別"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>p({...x,role:"farmer"}),className:`p-3 rounded-2xl font-bold transition-all shadow-sm ${"farmer"===x.role?"bg-[#16a34a] text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[a.jsx("i",{className:"fas fa-user mr-2"}),"農家"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>p({...x,role:"provider"}),className:`p-3 rounded-2xl font-bold transition-all shadow-sm ${"provider"===x.role?"bg-[#334155] text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[a.jsx("i",{className:"fas fa-building mr-2"}),"業者"]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"お名前"}),a.jsx("input",{type:"text",value:x.name,onChange:e=>p({...x,name:e.target.value}),className:"w-full p-4 bg-slate-50 rounded-2xl border border-slate-200 outline-none focus:ring-2 focus:ring-[#16a34a]",placeholder:"山田 太郎",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"電話番号"}),a.jsx("input",{type:"tel",value:x.phone,onChange:e=>p({...x,phone:e.target.value}),className:"w-full p-4 bg-slate-50 rounded-2xl border border-slate-200 outline-none focus:ring-2 focus:ring-[#16a34a]",placeholder:"090-1234-5678",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"メールアドレス"}),a.jsx("input",{type:"email",value:x.email,onChange:e=>p({...x,email:e.target.value}),className:"w-full p-4 bg-slate-50 rounded-2xl border border-slate-200 outline-none focus:ring-2 focus:ring-[#16a34a]",placeholder:"example@example.com",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"パスワード"}),a.jsx("input",{type:"password",value:x.password,onChange:e=>p({...x,password:e.target.value}),className:"w-full p-4 bg-slate-50 rounded-2xl border border-slate-200 outline-none focus:ring-2 focus:ring-[#16a34a]",placeholder:"8文字以上",required:!0,minLength:8})]}),"farmer"===x.role&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"招待コード（任意）"}),a.jsx("input",{type:"text",value:x.invitationCode,onChange:e=>p({...x,invitationCode:e.target.value}),className:"w-full p-4 bg-slate-50 rounded-2xl border border-slate-200 outline-none focus:ring-2 focus:ring-[#16a34a]",placeholder:"業者から受け取った招待コード"}),a.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"業者から招待コードを受け取っている場合は入力してください"})]}),a.jsx("button",{type:"submit",disabled:i,className:"w-full bg-[#16a34a] text-white py-4 rounded-2xl font-black shadow-sm hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:i?(0,a.jsxs)(a.Fragment,{children:[a.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"登録中..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("i",{className:"fas fa-user-plus mr-2"}),"新規登録"]})})]})]})]}),a.jsx("p",{className:"text-center text-slate-500 text-sm mt-6",children:"\xa9 2026 Wayfinder AgriX. All rights reserved."})]})})}},2041:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(5344),r=s(3729),l=s(6506),n=s(8428),i=s(2273),o=s(7121),d=s(4243),c=s(1917),u=s(9895),m=s(8120),x=s(5750);function p(){var e;let t=(0,n.usePathname)(),[s,p]=(0,r.useState)(null),[h,g]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(0,x.ts)().then(p).finally(()=>g(!1))},[]);let f=async()=>{await (0,x.w7)()},b="/login"===t;return a.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center",children:[(0,a.jsxs)(l.default,{href:"/",className:"text-xl font-black text-slate-800 tracking-tight hover:text-green-600 transition-colors",children:[a.jsx("span",{className:"text-green-600",children:"\uD83C\uDF3E"})," Wayfinder AgriX"]}),a.jsx("nav",{className:"flex items-center gap-3",children:h?a.jsx("span",{className:"text-slate-400 text-sm",children:"..."}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.default,{href:"admin"===(e=s.role)||"provider"===e?"/admin":"/",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[a.jsx(i.Z,{className:"w-4 h-4"}),"マイページ"]}),"farmer"===s.role&&(0,a.jsxs)(l.default,{href:"/#applications",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[a.jsx(o.Z,{className:"w-4 h-4"}),"申込履歴"]}),"provider"===s.role&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.default,{href:"/provider/reports/new",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[a.jsx(o.Z,{className:"w-4 h-4"}),"実績報告"]}),(0,a.jsxs)(l.default,{href:"/provider/billings",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[a.jsx(d.Z,{className:"w-4 h-4"}),"請求"]})]}),("admin"===s.role||"provider"===s.role)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.default,{href:"/admin/masters",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[a.jsx(c.Z,{className:"w-4 h-4"}),"マスタ"]}),(0,a.jsxs)(l.default,{href:"/admin/users",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[a.jsx(u.Z,{className:"w-4 h-4"}),"ユーザー"]})]}),(0,a.jsxs)("button",{type:"button",onClick:f,className:"text-sm font-bold text-slate-700 hover:text-red-600 transition-colors px-3 py-2 rounded-lg hover:bg-red-50 border border-slate-200 hover:border-red-200 flex items-center gap-1",children:[a.jsx(m.Z,{className:"w-4 h-4"}),"ログアウト"]})]}):a.jsx(l.default,{href:b?"/":"/login",className:"text-sm font-bold text-white bg-green-600 hover:bg-green-500 px-4 py-2 rounded-lg transition-colors",children:b?"トップへ":"ログイン"})})]})})}},5750:(e,t,s)=>{"use strict";s.d(t,{ts:()=>r,w7:()=>l});var a=s(8704);async function r(){try{let{data:{session:e}}=await a.O.auth.getSession();if(!e)return null;let{data:t,error:s}=await a.O.from("users").select("*").eq("email",e.user.email).single();if(s||!t)return null;return t}catch(e){return console.error("Error getting current user:",e),null}}async function l(){await a.O.auth.signOut(),window.location.href="/login"}},8704:(e,t,s)=>{"use strict";s.d(t,{O:()=>a});let a=(0,s(3974).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","sb_publishable_saY21TLJVLBNk5lg53j5Pg_PW9RAlEr")},7858:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p,metadata:()=>x});var a=s(5036),r=s(2574),l=s.n(r),n=s(2255),i=s.n(n);s(5023);let o=(0,s(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\components\Header.tsx`),{__esModule:d,$$typeof:c}=o,u=o.default;var m=s(7171);let x={title:"Wayfinder AgriX - ドローンあいのり予約",description:"農家と業者をつなぐ農作業予約プラットフォーム"};function p({children:e}){return a.jsx("html",{lang:"ja",children:(0,a.jsxs)("body",{className:`${l().variable} ${i().variable} font-sans antialiased`,children:[a.jsx(u,{}),e,a.jsx(m.x7,{position:"top-center",richColors:!0,closeButton:!0})]})})}},1613:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>r,default:()=>n});let a=(0,s(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\app\login\page.tsx`),{__esModule:r,$$typeof:l}=a,n=a.default},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(337);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,45,337],()=>s(6985));module.exports=a})();