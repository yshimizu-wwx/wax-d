(()=>{var e={};e.id=136,e.ids=[136],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},6977:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=s(482),a=s(9108),n=s(2563),i=s.n(n),l=s(8300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["provider",{children:["billings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9810)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\provider\\billings\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,7858)),"C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\yusuk\\Documents\\wwx\\Wayfinder AgriX\\v3-app\\src\\app\\provider\\billings\\page.tsx"],x="/provider/billings/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/provider/billings/page",pathname:"/provider/billings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9855:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2583,23)),Promise.resolve().then(s.t.bind(s,6840,23)),Promise.resolve().then(s.t.bind(s,8771,23)),Promise.resolve().then(s.t.bind(s,3225,23)),Promise.resolve().then(s.t.bind(s,9295,23)),Promise.resolve().then(s.t.bind(s,3982,23))},8750:(e,t,s)=>{Promise.resolve().then(s.bind(s,4755)),Promise.resolve().then(s.bind(s,2041))},8826:(e,t,s)=>{Promise.resolve().then(s.bind(s,8449))},2566:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(9224).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},7121:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(9224).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},8449:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5344),a=s(3729),n=s(8428),i=s(6506),l=s(2566),o=s(7121);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s(9224).Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);var c=s(5750),x=s(8704);function p(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)(null),[p,m]=(0,a.useState)([]),[u,h]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(async()=>{let t=await (0,c.ts)();if(!t||"provider"!==t.role){e.replace("/login");return}s(t);let{data:r}=await x.O.from("projects").select("id, campaign_title, location, final_date, status").eq("provider_id",t.id);if(!r?.length){h(!1);return}let{data:a}=await x.O.from("bookings").select("id, campaign_id, farmer_id, area_10r, actual_area_10r, work_status, final_amount, invoice_status").in("campaign_id",r.map(e=>e.id)).eq("work_status","completed"),n=a||[],i=[...new Set(n.map(e=>e.farmer_id).filter(Boolean))],l=new Map;if(i.length>0){let{data:e}=await x.O.from("users").select("id, name").in("id",i);l=new Map((e||[]).map(e=>[e.id,e]))}let o=new Map;r.forEach(e=>{o.set(e.id,{project:e,bookings:[],totalAmount:0})}),n.forEach(e=>{let t=o.get(e.campaign_id);if(!t)return;let s=e.farmer_id?l.get(e.farmer_id):void 0,r=Number(e.final_amount)||0;t.bookings.push({...e,farmer:s}),t.totalAmount+=r}),m(Array.from(o.values()).filter(e=>e.bookings.length>0)),h(!1)})()},[e]),u||!t)?r.jsx("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):r.jsx("main",{className:"min-h-screen bg-slate-50 print:bg-white",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-6 print:mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(i.default,{href:"/admin/campaigns",className:"p-2 rounded-lg border border-slate-200 hover:bg-white flex items-center gap-2 text-slate-600 print:hidden",children:[r.jsx(l.Z,{className:"w-5 h-5"}),"戻る"]}),(0,r.jsxs)("h1",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[r.jsx(o.Z,{className:"w-7 h-7 text-green-600"}),"請求管理"]})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>{window.print()},className:"flex items-center gap-2 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-600 print:hidden",children:[r.jsx(d,{className:"w-4 h-4"}),"印刷 / PDF"]})]}),0===p.length?(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 text-center text-slate-600",children:[r.jsx("p",{children:"作業完了済みの申込がありません。"}),r.jsx(i.default,{href:"/admin/campaigns",className:"mt-4 inline-block text-green-600 font-medium hover:underline",children:"案件一覧へ"})]}):r.jsx("div",{className:"space-y-8",children:p.map(({project:e,bookings:t,totalAmount:s})=>(0,r.jsxs)("section",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden print:break-inside-avoid",children:[(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:[r.jsx("h2",{className:"font-bold text-slate-800",children:e.campaign_title||e.location||e.id}),(0,r.jsxs)("p",{className:"text-sm text-slate-500",children:["確定日: ",e.final_date||"-"," ・ 完了申込 ",t.length," 件"]})]}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-slate-200 bg-slate-50/50",children:[r.jsx("th",{className:"text-left py-3 px-4 font-bold text-slate-700",children:"農家"}),r.jsx("th",{className:"text-right py-3 px-4 font-bold text-slate-700",children:"実績面積（反）"}),r.jsx("th",{className:"text-right py-3 px-4 font-bold text-slate-700",children:"確定金額"}),r.jsx("th",{className:"text-left py-3 px-4 font-bold text-slate-700",children:"請求状況"})]})}),r.jsx("tbody",{children:t.map(e=>(0,r.jsxs)("tr",{className:"border-b border-slate-100",children:[r.jsx("td",{className:"py-3 px-4 text-slate-800",children:e.farmer?.name??"—"}),r.jsx("td",{className:"py-3 px-4 text-right text-slate-700",children:e.actual_area_10r??e.area_10r??"-"}),(0,r.jsxs)("td",{className:"py-3 px-4 text-right font-medium text-slate-800",children:["\xa5",(Number(e.final_amount)||0).toLocaleString()]}),r.jsx("td",{className:"py-3 px-4 text-slate-600",children:"sent"===e.invoice_status||"processed"===e.invoice_status||"invoiced"===e.invoice_status?"請求済":"未請求"})]},e.id))}),r.jsx("tfoot",{children:(0,r.jsxs)("tr",{className:"bg-slate-50 font-bold",children:[r.jsx("td",{className:"py-3 px-4",colSpan:2,children:"合計"}),(0,r.jsxs)("td",{className:"py-3 px-4 text-right text-slate-800",children:["\xa5",s.toLocaleString()]}),r.jsx("td",{})]})})]})})]},e.id))})]})})}},2041:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5344),a=s(3729),n=s(6506),i=s(8428),l=s(2273),o=s(1917),d=s(9895),c=s(8120),x=s(5750);function p(){var e;let t=(0,i.usePathname)(),[s,p]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(0,x.ts)().then(p).finally(()=>u(!1))},[]);let h=async()=>{await (0,x.w7)()},g="/login"===t;return r.jsx("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center",children:[(0,r.jsxs)(n.default,{href:"/",className:"text-xl font-black text-slate-800 tracking-tight hover:text-green-600 transition-colors",children:[r.jsx("span",{className:"text-green-600",children:"\uD83C\uDF3E"})," Wayfinder AgriX"]}),r.jsx("nav",{className:"flex items-center gap-3",children:m?r.jsx("span",{className:"text-slate-400 text-sm",children:"..."}):s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.default,{href:"admin"===(e=s.role)||"provider"===e?"/admin":"/",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(l.Z,{className:"w-4 h-4"}),"マイページ"]}),("admin"===s.role||"provider"===s.role)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.default,{href:"/admin/masters",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(o.Z,{className:"w-4 h-4"}),"マスタ"]}),(0,r.jsxs)(n.default,{href:"/admin/users",className:"text-sm font-bold text-slate-700 hover:text-green-600 transition-colors px-3 py-2 rounded-lg hover:bg-slate-50 flex items-center gap-1",children:[r.jsx(d.Z,{className:"w-4 h-4"}),"ユーザー"]})]}),(0,r.jsxs)("button",{type:"button",onClick:h,className:"text-sm font-bold text-slate-700 hover:text-red-600 transition-colors px-3 py-2 rounded-lg hover:bg-red-50 border border-slate-200 hover:border-red-200 flex items-center gap-1",children:[r.jsx(c.Z,{className:"w-4 h-4"}),"ログアウト"]})]}):r.jsx(n.default,{href:g?"/":"/login",className:"text-sm font-bold text-white bg-green-600 hover:bg-green-500 px-4 py-2 rounded-lg transition-colors",children:g?"トップへ":"ログイン"})})]})})}},5750:(e,t,s)=>{"use strict";s.d(t,{ts:()=>a,w7:()=>n});var r=s(8704);async function a(){try{let{data:{session:e}}=await r.O.auth.getSession();if(!e)return null;let{data:t,error:s}=await r.O.from("users").select("*").eq("email",e.user.email).single();if(s||!t)return null;return t}catch(e){return console.error("Error getting current user:",e),null}}async function n(){await r.O.auth.signOut(),window.location.href="/login"}},8704:(e,t,s)=>{"use strict";s.d(t,{O:()=>r});let r=(0,s(3974).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","sb_publishable_saY21TLJVLBNk5lg53j5Pg_PW9RAlEr")},7858:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u,metadata:()=>m});var r=s(5036),a=s(3740),n=s.n(a),i=s(4070),l=s.n(i);s(5023);let o=(0,s(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\components\Header.tsx`),{__esModule:d,$$typeof:c}=o,x=o.default;var p=s(7171);let m={title:"Wayfinder AgriX - ドローンあいのり予約",description:"農家と業者をつなぐ農作業予約プラットフォーム"};function u({children:e}){return r.jsx("html",{lang:"ja",children:(0,r.jsxs)("body",{className:`${n().variable} ${l().variable} antialiased`,children:[r.jsx(x,{}),e,r.jsx(p.x7,{position:"top-center",richColors:!0,closeButton:!0})]})})}},9810:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>i});let r=(0,s(6843).createProxy)(String.raw`C:\Users\yusuk\Documents\wwx\Wayfinder AgriX\v3-app\src\app\provider\billings\page.tsx`),{__esModule:a,$$typeof:n}=r,i=r.default},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(337);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,916,337],()=>s(6977));module.exports=r})();