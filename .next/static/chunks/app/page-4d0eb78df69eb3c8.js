(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5441:function(e,t,r){Promise.resolve().then(r.bind(r,8836))},7461:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var l=r(4090),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),n=(e,t)=>{let r=(0,l.forwardRef)((r,n)=>{let{color:i="currentColor",size:d=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:u="",children:x,...m}=r;return(0,l.createElement)("svg",{ref:n,...s,width:d,height:d,stroke:i,strokeWidth:c?24*Number(o)/Number(d):o,className:["lucide","lucide-".concat(a(e)),u].join(" "),...m},[...t.map(e=>{let[t,r]=e;return(0,l.createElement)(t,r)}),...Array.isArray(x)?x:[x]])});return r.displayName="".concat(e),r}},7307:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,r(7461).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},8994:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,r(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2457:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,r(7461).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4232:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var l=r(4930),s=r.n(l)},4930:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let l=r(6921);r(3827),r(4090);let s=l._(r(4795));function a(e,t){let r={loading:e=>{let{error:t,isLoading:r,pastDelay:l}=e;return null}};return"function"==typeof e&&(r.loader=e),(0,s.default)({...r,...t})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9721:function(e,t,r){"use strict";function l(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}}),r(9775)},4795:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let l=r(3827),s=r(4090),a=r(9721);function n(e){var t;return{default:null!=(t=null==e?void 0:e.default)?t:e}}let i={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},d=function(e){let t={...i,...e},r=(0,s.lazy)(()=>t.loader().then(n)),d=t.loading;function o(e){let n=d?(0,l.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,i=t.ssr?(0,l.jsx)(r,{...e}):(0,l.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(r,{...e})});return(0,l.jsx)(s.Suspense,{fallback:n,children:i})}return o.displayName="LoadableComponent",o}},8836:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var l=r(3827),s=r(4090),a=r(4232),n=r(8994),i=r(2457),d=r(7307),o=r(6288),c=r(407),u=r(8222),x=r(8793);let m=(0,a.default)(()=>Promise.all([r.e(212),r.e(590),r.e(566)]).then(r.bind(r,8995)),{loadableGenerated:{webpack:()=>[8995]},ssr:!1,loading:()=>(0,l.jsx)("div",{className:"w-full h-full bg-slate-100 animate-pulse rounded-2xl flex items-center justify-center text-slate-400",children:"地図を読み込み中..."})}),f=(0,a.default)(()=>r.e(435).then(r.bind(r,1435)),{loadableGenerated:{webpack:()=>[1435]},ssr:!1});function h(){let[e,t]=(0,s.useState)(null),[r,a]=(0,s.useState)(!0),[h,p]=(0,s.useState)(0),[b,g]=(0,s.useState)(null),[j,y]=(0,s.useState)(null),[_,N]=(0,s.useState)(0),[w,v]=(0,s.useState)(null),[k,P]=(0,s.useState)(null);(0,s.useEffect)(()=>{(0,x.ts)().then(e=>{(null==e?void 0:e.id)&&v(e.id),(null==e?void 0:e.role)&&P(e.role)})},[]),(0,s.useEffect)(()=>{(async function(){let e=await (0,u.g8)();t(e),e&&N(await (0,u.x1)(e.id)),a(!1)})()},[]);let Z=async t=>{var r,l;if(!e||!b){o.toast.error("案件情報または圃場データが不足しています");return}let s={base_price:e.base_price||0,min_price:e.min_price||0,target_area_10r:e.target_area_10r||0,min_target_area_10r:e.min_target_area_10r,max_target_area_10r:e.max_target_area_10r,execution_price:e.execution_price},a=_+h,n=null!==(l=null!==(r=(0,c.Bx)(s,a).currentPrice)&&void 0!==r?r:e.base_price)&&void 0!==l?l:0,i={campaign_id:e.id,farmer_id:"farmer"===k&&w?w:void 0,farmer_name:t.farmerName,phone:t.phone,email:t.email,desired_start_date:t.desiredStartDate,desired_end_date:t.desiredEndDate,field_polygon:b,area_10r:h,locked_price:n},d=await (0,u.TB)(i);d.success?(o.toast.success("予約が完了しました。予約ID: ".concat(d.bookingId)),p(0),g(null),y(null),window.location.reload()):o.toast.error(d.error||"予約に失敗しました")};return r?(0,l.jsx)("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,l.jsx)(n.Z,{className:"w-10 h-10 text-green-600 animate-spin"}),(0,l.jsx)("p",{className:"text-slate-600 font-medium",children:"読み込み中..."})]})}):e?(0,l.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-green-50/30",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-8",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.Z,{className:"w-5 h-5 text-green-600"}),(0,l.jsx)("p",{className:"text-slate-700 font-bold",children:"募集中の案件"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("div",{className:"bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-200 flex items-center gap-1",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4 text-blue-600"}),(0,l.jsxs)("span",{className:"text-blue-700 font-bold text-xs",children:["累計: ",_.toFixed(1)," 反"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 bg-green-50 px-4 py-2 rounded-full border border-green-200",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,l.jsx)("span",{className:"text-green-700 font-bold text-sm",children:"募集中"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsx)("section",{className:"order-2 lg:order-1",children:(0,l.jsxs)("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 h-[500px] lg:h-[700px] relative",children:[(0,l.jsxs)("div",{className:"absolute top-6 left-6 z-[1000] bg-white/95 backdrop-blur px-4 py-2 rounded-xl shadow-md border border-slate-200 flex items-center gap-2",children:[(0,l.jsx)(i.Z,{className:"w-5 h-5 text-green-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sm font-bold text-slate-600",children:"圃場を描画"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"地図上でクリックして圃場の範囲を指定"})]})]}),h>0&&(0,l.jsxs)("div",{className:"absolute top-6 right-6 z-[1000] bg-green-600 text-white px-5 py-3 rounded-xl shadow-lg border-2 border-green-500 min-w-[180px]",children:[(0,l.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider mb-1 opacity-90",children:"選択面積"}),(0,l.jsxs)("div",{className:"text-3xl font-black",children:[h.toFixed(2)," ",(0,l.jsx)("span",{className:"text-sm font-normal opacity-90",children:"反"})]})]}),(0,l.jsx)("div",{className:"w-full h-full rounded-xl overflow-hidden",children:(0,l.jsx)(m,{onPolygonComplete:(e,t,r)=>{y(e),p(t),g(r)},initialPolygon:j||void 0})})]})}),(0,l.jsx)("section",{className:"order-1 lg:order-2",children:(0,l.jsx)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:(0,l.jsx)(f,{project:e,area10r:h,totalCampaignArea:_,onSubmit:Z})})})]}),(0,l.jsx)("footer",{className:"mt-8 text-center text-sm text-slate-500",children:(0,l.jsx)("p",{children:"ご不明な点がございましたら、お気軽にお問い合わせください。"})})]})}):(0,l.jsx)("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-slate-200 max-w-md text-center",children:[(0,l.jsx)("div",{className:"flex justify-center mb-4",children:(0,l.jsx)(i.Z,{className:"w-16 h-16 text-slate-300"})}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"現在募集中の案件はありません"}),(0,l.jsx)("p",{className:"text-slate-600",children:"新しい案件が開始されるまでお待ちください。"})]})})}}},function(e){e.O(0,[866,755,288,11,121,971,69,744],function(){return e(e.s=5441)}),_N_E=e.O()}]);