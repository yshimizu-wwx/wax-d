(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{5351:function(e,t,r){Promise.resolve().then(r.bind(r,4998))},559:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},7307:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},3441:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9475:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},5423:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},2457:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4697:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},5310:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},9990:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},9299:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]])},5497:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},1213:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},8792:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var n=r(5250),s=r.n(n)},7907:function(e,t,r){"use strict";var n=r(5313);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},4998:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return O}});var n=r(3827),s=r(4090),a=r(7907),i=r(8793),l=r(8792),c=r(1213),o=r(3441),u=r(5423),d=r(7461);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,d.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var f=r(2169);function m(){var e;let t=(0,a.usePathname)(),[r,d]=(0,s.useState)(null),[m,x]=(0,s.useState)(!0),[p,y]=(0,s.useState)(!1),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{(0,i.ts)().then(d).finally(()=>x(!1))},[]),(0,s.useEffect)(()=>{if(!p)return;let e=e=>{b.current&&!b.current.contains(e.target)&&y(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[p]);let v=async()=>{y(!1),await (0,i.w7)()},g="/login"===t;return m?(0,n.jsx)("div",{className:"h-10 w-10 rounded-full bg-slate-200 animate-pulse","aria-hidden":!0}):r?(0,n.jsxs)("div",{className:"relative",ref:b,children:[(0,n.jsxs)("button",{type:"button",onClick:()=>y(e=>!e),className:(0,f.cn)("flex items-center gap-2 rounded-xl px-2 py-2 md:pl-3 md:pr-3 border border-slate-200 bg-white hover:bg-slate-50 transition-colors","focus:outline-none focus:ring-2 focus:ring-agrix-forest focus:ring-offset-2"),"aria-expanded":p,"aria-haspopup":"true",children:[(0,n.jsx)("span",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-agrix-forest text-white font-bold text-sm",children:(0,n.jsx)(c.Z,{className:"h-5 w-5"})}),(0,n.jsx)("span",{className:"hidden md:inline text-sm font-bold text-slate-800 truncate max-w-[8rem]",children:(null===(e=r.email)||void 0===e?void 0:e.split("@")[0])||"マイページ"}),(0,n.jsx)(o.Z,{className:(0,f.cn)("h-4 w-4 text-slate-500 transition-transform",p&&"rotate-180")})]}),p&&(0,n.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-56 rounded-xl border border-slate-200 bg-white shadow-lg py-1 z-50",role:"menu",children:[(0,n.jsxs)("div",{className:"px-3 py-2 border-b border-slate-100",children:[(0,n.jsx)("p",{className:"text-xs text-slate-500",children:"ログイン中"}),(0,n.jsx)("p",{className:"text-sm font-bold text-slate-800 truncate",children:r.email})]}),(0,n.jsxs)(l.default,{href:(r.role,"/mypage"),onClick:()=>y(!1),className:"flex items-center gap-2 px-3 py-2.5 text-sm font-medium text-slate-700 hover:bg-slate-50",role:"menuitem",children:[(0,n.jsx)(u.Z,{className:"h-4 w-4 text-agrix-forest"}),"マイページ"]}),(0,n.jsxs)("button",{type:"button",onClick:v,className:"flex w-full items-center gap-2 px-3 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50",role:"menuitem",children:[(0,n.jsx)(h,{className:"h-4 w-4"}),"ログアウト"]})]})]}):(0,n.jsx)(l.default,{href:g?"/":"/login",className:(0,f.cn)("inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2.5 text-sm font-bold transition-colors","bg-agrix-forest text-white hover:bg-agrix-forest-dark shadow-sm"),children:g?"トップへ":"ログイン"})}function x(){return(0,n.jsx)("header",{className:"bg-dashboard-card border-b border-dashboard-border sticky top-0 z-50 shadow-sm",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center",children:[(0,n.jsx)("div",{className:"flex-1 min-w-0 flex items-center",children:(0,n.jsxs)(l.default,{href:"/",className:"text-dashboard-text font-bold text-lg truncate hover:text-agrix-forest transition-colors flex items-center gap-1.5",children:[(0,n.jsx)("span",{className:"text-agrix-forest","aria-hidden":!0,children:"\uD83C\uDF3E"}),(0,n.jsx)("span",{children:"Wayfinder AgriX Drone"})]})}),(0,n.jsx)(m,{})]})})}var p=r(2457),y=r(9990),b=r(9475),v=r(9299),g=r(5310),w=r(7307);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let k=(0,d.Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);var j=r(4697),Z=r(559),N=r(5497);function M(e){let t=[{href:"admin"===e||"provider"===e?"/admin":"/",label:"ダッシュボード",icon:u.Z}];return"farmer"===e&&(t.push({href:"/case-map",label:"地図で探す",icon:p.Z}),t.push({href:"/requests",label:"作業依頼",icon:y.Z}),t.push({href:"/#applications",label:"申込履歴",icon:b.Z}),t.push({href:"/my-fields",label:"My畑",icon:v.Z})),"provider"===e&&(t.push({href:"/admin/campaigns/new",label:"案件作成",icon:g.Z}),t.push({href:"/provider/calendar",label:"カレンダー",icon:w.Z}),t.push({href:"/provider/reports/new",label:"実績報告",icon:b.Z}),t.push({href:"/provider/billings",label:"請求管理",icon:k}),t.push({href:"/admin/masters",label:"マスタ",icon:j.Z}),t.push({href:"/admin/users",label:"紐付き農家",icon:Z.Z})),"admin"===e&&(t.push({href:"/admin/users",label:"ユーザー承認",icon:N.Z}),t.push({href:"/admin/masters",label:"マスタ",icon:j.Z})),t}function z(e){let{user:t,className:r}=e,s=(0,a.usePathname)(),i=M(t.role);return(0,n.jsx)("aside",{className:(0,f.cn)("hidden md:flex flex-col w-64 shrink-0 bg-agrix-forest border-r border-white/10",r),children:(0,n.jsx)("nav",{className:"flex-1 p-3 pt-5 space-y-1 overflow-y-auto",children:i.map(e=>{let t=e.icon,r=s===e.href||"/"!==e.href&&s.startsWith(e.href);return(0,n.jsxs)(l.default,{href:e.href,className:(0,f.cn)("flex items-center gap-3 rounded-xl px-3 py-3 text-sm font-bold transition-colors",r?"bg-white/20 text-white shadow-inner":"text-white/90 hover:bg-white/10 hover:text-white"),children:[(0,n.jsx)(t,{className:"h-5 w-5 shrink-0"}),e.label]},e.href)})})})}function C(e){let{user:t,className:r}=e,s=(0,a.usePathname)(),i=M(t.role).slice(0,5);return(0,n.jsx)("nav",{className:(0,f.cn)("fixed bottom-0 left-0 right-0 z-40 md:hidden border-t border-white/10 bg-agrix-forest safe-area-pb",r),children:(0,n.jsx)("div",{className:"flex items-center justify-around h-16 safe-area-pb",children:i.map(e=>{let t=e.icon,r=s===e.href||"/"!==e.href&&s.startsWith(e.href);return(0,n.jsxs)(l.default,{href:e.href,className:(0,f.cn)("flex flex-col items-center justify-center gap-1 flex-1 min-w-0 py-3 text-xs font-bold transition-colors min-h-[44px]",r?"text-white bg-white/20":"text-white/80 hover:text-white hover:bg-white/10"),children:[(0,n.jsx)(t,{className:(0,f.cn)("h-6 w-6 shrink-0",r&&"stroke-[2.5]")}),(0,n.jsx)("span",{className:"truncate max-w-[4.5rem]",children:e.label})]},e.href)})})})}let P=["/login","/auth"];function O(e){let{children:t}=e,r=(0,a.usePathname)(),[l,c]=(0,s.useState)(null),[o,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(0,i.ts)().then(c).finally(()=>u(!1))},[]);let d=P.some(e=>r===e||r.startsWith(e+"/")),h=!d&&!!l;return d?(0,n.jsx)(n.Fragment,{children:t}):(0,n.jsxs)("div",{className:(0,f.cn)("min-h-screen",!d&&"dashboard-app bg-dashboard-bg"),children:[(0,n.jsx)(x,{}),(0,n.jsxs)("div",{className:"flex min-h-[calc(100vh-4rem)]",children:[h&&l&&(0,n.jsx)(z,{user:l}),(0,n.jsx)("main",{className:(0,f.cn)("relative z-0 flex-1 w-full min-h-[calc(100vh-4rem)] overflow-auto",h&&"pb-20 md:pb-0 md:px-6 md:py-6"),children:t})]}),h&&l&&(0,n.jsx)(C,{user:l})]})}},8793:function(e,t,r){"use strict";r.d(t,{Lj:function(){return i},gQ:function(){return l},ts:function(){return s},w7:function(){return a}});var n=r(4958);async function s(){try{var e,t,r,s,a,i,l,c,o;let{data:{session:u}}=await n.O.auth.getSession();if(!u)return null;let{data:d,error:h}=await n.O.from("users").select("*").eq("email",u.user.email).single();if(h||!d)return null;return{id:d.id,email:null!==(e=d.email)&&void 0!==e?e:"",role:d.role,name:null!==(t=d.name)&&void 0!==t?t:"",phone:null!==(r=d.phone)&&void 0!==r?r:"",status:null!==(s=d.status)&&void 0!==s?s:"",address:null!==(a=d.address)&&void 0!==a?a:void 0,lat:null!==(i=d.lat)&&void 0!==i?i:void 0,lng:null!==(l=d.lng)&&void 0!==l?l:void 0,associated_provider_id:null!==(c=d.associated_provider_id)&&void 0!==c?c:void 0,invitation_code:null!==(o=d.invitation_code)&&void 0!==o?o:void 0}}catch(e){return console.error("Error getting current user:",e),null}}async function a(){await n.O.auth.signOut(),window.location.href="/login"}async function i(e){try{var t;let{data:{session:r}}=await n.O.auth.getSession();if(!(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.email))return{success:!1,error:"ログインしていません"};let{error:s}=await n.O.from("users").update({...void 0!==e.name&&{name:e.name},...void 0!==e.phone&&{phone:e.phone},...void 0!==e.address&&{address:e.address}}).eq("email",r.user.email);if(s)return{success:!1,error:s.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function l(e){try{let{error:t}=await n.O.auth.updateUser({password:e});if(t)return{success:!1,error:t.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}},4958:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});let n=(0,r(342).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5dmllb3J3bnl4eGZ5Z2Joem55Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MjY1OTUsImV4cCI6MjA4NjQwMjU5NX0.-alPp1Cr1J2yoKcdaln4LMbOPjaGCb4wRjURGhibLPk")},2169:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(3167),s=r(1367);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}}},function(e){e.O(0,[128,150,250,971,69,744],function(){return e(e.s=5351)}),_N_E=e.O()}]);