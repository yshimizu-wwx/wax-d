(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{710:function(e,n,t){Promise.resolve().then(t.bind(t,9278))},8994:function(e,n,t){"use strict";t.d(n,{Z:function(){return r}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4232:function(e,n,t){"use strict";t.d(n,{default:function(){return u.a}});var r=t(4930),u=t.n(r)},7907:function(e,n,t){"use strict";var r=t(5313);t.o(r,"usePathname")&&t.d(n,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(n,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(n,{useSearchParams:function(){return r.useSearchParams}})},4930:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return s}});let r=t(6921);t(3827),t(4090);let u=r._(t(4795));function s(e,n){let t={loading:e=>{let{error:n,isLoading:t,pastDelay:r}=e;return null}};return"function"==typeof e&&(t.loader=e),(0,u.default)({...t,...n})}("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),e.exports=n.default)},9721:function(e,n,t){"use strict";function r(e){let{reason:n,children:t}=e;return t}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"BailoutToCSR",{enumerable:!0,get:function(){return r}}),t(9775)},4795:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return o}});let r=t(3827),u=t(4090),s=t(9721);function i(e){var n;return{default:null!=(n=null==e?void 0:e.default)?n:e}}let a={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},o=function(e){let n={...a,...e},t=(0,u.lazy)(()=>n.loader().then(i)),o=n.loading;function l(e){let i=o?(0,r.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,a=n.ssr?(0,r.jsx)(t,{...e}):(0,r.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(t,{...e})});return(0,r.jsx)(u.Suspense,{fallback:i,children:a})}return l.displayName="LoadableComponent",l}},9278:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return c}});var r=t(3827),u=t(4090),s=t(7907),i=t(4232),a=t(8793),o=t(8228);let l=(0,i.default)(()=>Promise.all([t.e(866),t.e(212),t.e(250),t.e(11),t.e(281),t.e(7)]).then(t.bind(t,9007)),{loadableGenerated:{webpack:()=>[9007]},ssr:!1,loading:()=>(0,r.jsx)("main",{className:"min-h-full flex items-center justify-center",children:(0,r.jsx)(o.Z,{message:"読み込み中..."})})});function c(){let e=(0,s.useRouter)(),[n,t]=(0,u.useState)(!0);return((0,u.useEffect)(()=>{(0,a.ts)().then(n=>{if(!n){e.replace("/login");return}if("farmer"!==n.role){e.replace("/");return}t(!1)})},[e]),n)?(0,r.jsx)("main",{className:"min-h-full flex items-center justify-center",children:(0,r.jsx)(o.Z,{message:"リダイレクト中..."})}):(0,r.jsx)(l,{})}},8228:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(3827),u=t(8994),s=t(2169);function i(e){let{message:n="読み込み中...",className:t}=e;return(0,r.jsxs)("div",{className:(0,s.cn)("flex min-h-[40vh] flex-col items-center justify-center gap-4",t),children:[(0,r.jsx)(u.Z,{className:"h-12 w-12 text-agrix-forest animate-spin","aria-hidden":!0}),(0,r.jsx)("p",{className:"text-sm font-medium text-slate-600",children:n})]})}},8793:function(e,n,t){"use strict";t.d(n,{Lj:function(){return i},gQ:function(){return a},ts:function(){return u},w7:function(){return s}});var r=t(4958);async function u(){try{var e,n,t,u,s,i,a,o,l;let{data:{session:c}}=await r.O.auth.getSession();if(!c)return null;let{data:d,error:f}=await r.O.from("users").select("*").eq("email",c.user.email).single();if(f||!d)return null;return{id:d.id,email:null!==(e=d.email)&&void 0!==e?e:"",role:d.role,name:null!==(n=d.name)&&void 0!==n?n:"",phone:null!==(t=d.phone)&&void 0!==t?t:"",status:null!==(u=d.status)&&void 0!==u?u:"",address:null!==(s=d.address)&&void 0!==s?s:void 0,lat:null!==(i=d.lat)&&void 0!==i?i:void 0,lng:null!==(a=d.lng)&&void 0!==a?a:void 0,associated_provider_id:null!==(o=d.associated_provider_id)&&void 0!==o?o:void 0,invitation_code:null!==(l=d.invitation_code)&&void 0!==l?l:void 0}}catch(e){return console.error("Error getting current user:",e),null}}async function s(){await r.O.auth.signOut(),window.location.href="/login"}async function i(e){try{var n;let{data:{session:t}}=await r.O.auth.getSession();if(!(null==t?void 0:null===(n=t.user)||void 0===n?void 0:n.email))return{success:!1,error:"ログインしていません"};let{error:u}=await r.O.from("users").update({...void 0!==e.name&&{name:e.name},...void 0!==e.phone&&{phone:e.phone},...void 0!==e.address&&{address:e.address}}).eq("email",t.user.email);if(u)return{success:!1,error:u.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function a(e){try{let{error:n}=await r.O.auth.updateUser({password:e});if(n)return{success:!1,error:n.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}},4958:function(e,n,t){"use strict";t.d(n,{O:function(){return r}});let r=(0,t(342).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5dmllb3J3bnl4eGZ5Z2Joem55Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MjY1OTUsImV4cCI6MjA4NjQwMjU5NX0.-alPp1Cr1J2yoKcdaln4LMbOPjaGCb4wRjURGhibLPk")},2169:function(e,n,t){"use strict";t.d(n,{cn:function(){return s}});var r=t(3167),u=t(1367);function s(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,u.m6)((0,r.W)(n))}}},function(e){e.O(0,[128,150,971,69,744],function(){return e(e.s=710)}),_N_E=e.O()}]);