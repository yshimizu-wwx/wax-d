(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{5351:function(e,t,r){Promise.resolve().then(r.bind(r,4998))},3441:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9475:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},8745:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]])},5423:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},6885:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]])},2457:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4697:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},9990:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},9910:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9299:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]])},5497:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},1213:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(7461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},8792:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var n=r(5250),a=r.n(n)},7907:function(e,t,r){"use strict";var n=r(5313);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},4998:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r(3827),a=r(4090),s=r(7907),i=r(8793),l=r(8792),o=r(1213),c=r(3441),u=r(5423),d=r(7461);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,d.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var f=r(2169);function m(){var e;let t=(0,s.usePathname)(),[r,d]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[p,y]=(0,a.useState)(!1),v=(0,a.useRef)(null);(0,a.useEffect)(()=>{(0,i.ts)().then(d).finally(()=>x(!1))},[]),(0,a.useEffect)(()=>{if(!p)return;let e=e=>{v.current&&!v.current.contains(e.target)&&y(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[p]);let b=async()=>{y(!1),await (0,i.w7)()},g="/login"===t;return m?(0,n.jsx)("div",{className:"h-10 w-10 rounded-full bg-slate-200 animate-pulse","aria-hidden":!0}):r?(0,n.jsxs)("div",{className:"relative",ref:v,children:[(0,n.jsxs)("button",{type:"button",onClick:()=>y(e=>!e),className:(0,f.cn)("flex items-center gap-2 rounded-xl px-2 py-2 md:pl-3 md:pr-3 border border-slate-200 bg-white hover:bg-slate-50 transition-colors","focus:outline-none focus:ring-2 focus:ring-agrix-forest focus:ring-offset-2"),"aria-expanded":p,"aria-haspopup":"true",children:[(0,n.jsx)("span",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-agrix-forest text-white font-bold text-sm",children:(0,n.jsx)(o.Z,{className:"h-5 w-5"})}),(0,n.jsx)("span",{className:"hidden md:inline text-sm font-bold text-slate-800 truncate max-w-[8rem]",children:(null===(e=r.email)||void 0===e?void 0:e.split("@")[0])||"マイページ"}),(0,n.jsx)(c.Z,{className:(0,f.cn)("h-4 w-4 text-slate-500 transition-transform",p&&"rotate-180")})]}),p&&(0,n.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-56 rounded-xl border border-slate-200 bg-white shadow-lg py-1 z-50",role:"menu",children:[(0,n.jsxs)("div",{className:"px-3 py-2 border-b border-slate-100",children:[(0,n.jsx)("p",{className:"text-xs text-slate-500",children:"ログイン中"}),(0,n.jsx)("p",{className:"text-sm font-bold text-slate-800 truncate",children:r.email})]}),(0,n.jsxs)(l.default,{href:(r.role,"/mypage"),onClick:()=>y(!1),className:"flex items-center gap-2 px-3 py-2.5 text-sm font-medium text-slate-700 hover:bg-slate-50",role:"menuitem",children:[(0,n.jsx)(u.Z,{className:"h-4 w-4 text-agrix-forest"}),"マイページ"]}),(0,n.jsxs)("button",{type:"button",onClick:b,className:"flex w-full items-center gap-2 px-3 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50",role:"menuitem",children:[(0,n.jsx)(h,{className:"h-4 w-4"}),"ログアウト"]})]})]}):(0,n.jsx)(l.default,{href:g?"/":"/login",className:(0,f.cn)("inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2.5 text-sm font-bold transition-colors","bg-agrix-forest text-white hover:bg-agrix-forest-dark shadow-sm"),children:g?"トップへ":"ログイン"})}function x(){return(0,n.jsx)("header",{className:"bg-dashboard-card border-b border-white/10 sticky top-0 z-50 shadow-sm backdrop-blur-sm",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center",children:[(0,n.jsx)("div",{className:"flex-1 min-w-0 flex items-center",children:(0,n.jsx)(l.default,{href:"/",className:"text-dashboard-text font-bold text-lg truncate hover:text-agrix-forest transition-colors flex items-center gap-1.5",children:(0,n.jsx)("span",{children:"Wayfinder AgriX Drone"})})}),(0,n.jsx)(m,{})]})})}var p=r(2457),y=r(9990),v=r(9475),b=r(9299),g=r(8745),k=r(6885);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let w=(0,d.Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);var j=r(9910),Z=r(5497),N=r(4697);function M(e){let t=[{href:"admin"===e||"provider"===e?"/admin":"/",label:"ダッシュボード",icon:u.Z}];return"farmer"===e&&(t.push({href:"/case-map",label:"地図で探す",icon:p.Z}),t.push({href:"/requests",label:"作業依頼",icon:y.Z}),t.push({href:"/#applications",label:"申込履歴",icon:v.Z}),t.push({href:"/my-fields",label:"My畑",icon:b.Z})),"provider"===e&&(t.push({href:"/provider/projects",label:"案件",icon:g.Z}),t.push({href:"/provider/tasks",label:"作業",icon:k.Z}),t.push({href:"/provider/billings",label:"請求",icon:w}),t.push({href:"/provider/settings",label:"設定",icon:j.Z})),"admin"===e&&(t.push({href:"/admin/users",label:"ユーザー承認",icon:Z.Z}),t.push({href:"/admin/masters",label:"マスタ",icon:N.Z})),t}function z(e){let{user:t,className:r}=e,a=(0,s.usePathname)(),i=M(t.role);return(0,n.jsx)("aside",{className:(0,f.cn)("hidden md:flex flex-col w-64 shrink-0 bg-slate-900/50 backdrop-blur-xl border-r border-white/10",r),children:(0,n.jsx)("nav",{className:"flex-1 p-3 pt-5 space-y-1 overflow-y-auto",children:i.map(e=>{let t=e.icon,r=a===e.href||"/"!==e.href&&a.startsWith(e.href);return(0,n.jsxs)(l.default,{href:e.href,className:(0,f.cn)("flex items-center gap-3 rounded-xl pl-3 pr-3 py-3 text-sm font-bold transition-colors border-l-4",r?"border-l-cyan-400 text-cyan-400 bg-white/5":"border-l-transparent text-slate-400 hover:text-white hover:bg-white/5"),children:[(0,n.jsx)(t,{className:"h-5 w-5 shrink-0"}),e.label]},e.href)})})})}function O(e){let{user:t,className:r}=e,a=(0,s.usePathname)(),i=M(t.role).slice(0,5);return(0,n.jsx)("nav",{className:(0,f.cn)("fixed bottom-0 left-0 right-0 z-40 md:hidden border-t border-white/10 bg-agrix-forest safe-area-pb",r),children:(0,n.jsx)("div",{className:"flex items-center justify-around h-16 safe-area-pb",children:i.map(e=>{let t=e.icon,r=a===e.href||"/"!==e.href&&a.startsWith(e.href);return(0,n.jsxs)(l.default,{href:e.href,className:(0,f.cn)("flex flex-col items-center justify-center gap-1 flex-1 min-w-0 py-3 text-xs font-bold transition-colors min-h-[44px]",r?"text-white bg-white/20":"text-white/80 hover:text-white hover:bg-white/10"),children:[(0,n.jsx)(t,{className:(0,f.cn)("h-6 w-6 shrink-0",r&&"stroke-[2.5]")}),(0,n.jsx)("span",{className:"truncate max-w-[4.5rem]",children:e.label})]},e.href)})})})}let P=["/login","/auth"];function I(e){let{children:t}=e,r=(0,s.usePathname)(),[l,o]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(0,i.ts)().then(o).finally(()=>u(!1))},[]);let d=P.some(e=>r===e||r.startsWith(e+"/")),h=!d&&!!l;return d?(0,n.jsx)(n.Fragment,{children:t}):(0,n.jsxs)("div",{className:(0,f.cn)("min-h-screen",!d&&"dashboard-app bg-dashboard-bg"),children:[(0,n.jsx)(x,{}),(0,n.jsxs)("div",{className:"flex min-h-[calc(100vh-4rem)]",children:[h&&l&&(0,n.jsx)(z,{user:l}),(0,n.jsx)("main",{className:(0,f.cn)("relative z-0 flex-1 w-full min-h-[calc(100vh-4rem)] overflow-auto",h&&"pb-20 md:pb-0 md:px-6 md:py-6"),children:t})]}),h&&l&&(0,n.jsx)(O,{user:l})]})}},8793:function(e,t,r){"use strict";r.d(t,{Lj:function(){return i},gQ:function(){return l},ts:function(){return a},w7:function(){return s}});var n=r(4958);async function a(){try{var e,t,r,a,s,i,l,o,c,u;let{data:{session:d}}=await n.O.auth.getSession();if(!(null==d?void 0:null===(e=d.user)||void 0===e?void 0:e.email))return null;let{data:h,error:f}=await n.O.from("users").select("*").eq("email",d.user.email).single();if(f||!h)return null;return{id:h.id,email:null!==(t=h.email)&&void 0!==t?t:"",role:h.role,name:null!==(r=h.name)&&void 0!==r?r:"",phone:null!==(a=h.phone)&&void 0!==a?a:"",status:null!==(s=h.status)&&void 0!==s?s:"",address:null!==(i=h.address)&&void 0!==i?i:void 0,lat:null!==(l=h.lat)&&void 0!==l?l:void 0,lng:null!==(o=h.lng)&&void 0!==o?o:void 0,associated_provider_id:null!==(c=h.associated_provider_id)&&void 0!==c?c:void 0,invitation_code:null!==(u=h.invitation_code)&&void 0!==u?u:void 0}}catch(e){return console.error("Error getting current user:",e),null}}async function s(){await n.O.auth.signOut(),window.location.href="/login"}async function i(e){try{var t;let{data:{session:r}}=await n.O.auth.getSession();if(!(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.email))return{success:!1,error:"ログインしていません"};let{error:a}=await n.O.from("users").update({...void 0!==e.name&&{name:e.name},...void 0!==e.phone&&{phone:e.phone},...void 0!==e.address&&{address:e.address}}).eq("email",r.user.email);if(a)return{success:!1,error:a.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function l(e){try{let{error:t}=await n.O.auth.updateUser({password:e});if(t)return{success:!1,error:t.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}},4958:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});let n=(0,r(342).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5dmllb3J3bnl4eGZ5Z2Joem55Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MjY1OTUsImV4cCI6MjA4NjQwMjU5NX0.-alPp1Cr1J2yoKcdaln4LMbOPjaGCb4wRjURGhibLPk")},2169:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var n=r(3167),a=r(1367);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}}},function(e){e.O(0,[128,150,250,971,69,744],function(){return e(e.s=5351)}),_N_E=e.O()}]);