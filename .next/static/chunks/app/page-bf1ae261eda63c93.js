(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5441:function(e,t,s){Promise.resolve().then(s.bind(s,8488))},7461:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(4090),l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),n=(e,t)=>{let s=(0,a.forwardRef)((s,n)=>{let{color:i="currentColor",size:d=24,strokeWidth:c=2,absoluteStrokeWidth:o,className:x="",children:u,...m}=s;return(0,a.createElement)("svg",{ref:n,...l,width:d,height:d,stroke:i,strokeWidth:o?24*Number(c)/Number(d):c,className:["lucide","lucide-".concat(r(e)),x].join(" "),...m},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(u)?u:[u]])});return s.displayName="".concat(e),s}},8025:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},7307:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},9475:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},8994:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2457:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4232:function(e,t,s){"use strict";s.d(t,{default:function(){return l.a}});var a=s(4930),l=s.n(a)},8792:function(e,t,s){"use strict";s.d(t,{default:function(){return l.a}});var a=s(5250),l=s.n(a)},7907:function(e,t,s){"use strict";var a=s(5313);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},4930:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let a=s(6921);s(3827),s(4090);let l=a._(s(4795));function r(e,t){let s={loading:e=>{let{error:t,isLoading:s,pastDelay:a}=e;return null}};return"function"==typeof e&&(s.loader=e),(0,l.default)({...s,...t})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9721:function(e,t,s){"use strict";function a(e){let{reason:t,children:s}=e;return s}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}}),s(9775)},4795:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let a=s(3827),l=s(4090),r=s(9721);function n(e){var t;return{default:null!=(t=null==e?void 0:e.default)?t:e}}let i={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},d=function(e){let t={...i,...e},s=(0,l.lazy)(()=>t.loader().then(n)),d=t.loading;function c(e){let n=d?(0,a.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,i=t.ssr?(0,a.jsx)(s,{...e}):(0,a.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(s,{...e})});return(0,a.jsx)(l.Suspense,{fallback:n,children:i})}return c.displayName="LoadableComponent",c}},8488:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var a=s(3827),l=s(4090),r=s(4232),n=s(8792),i=s(7907),d=s(8994),c=s(7461);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,c.Z)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);var x=s(7307),u=s(8025),m=s(2457),h=s(9475);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,c.Z)("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);var p=s(6288),j=s(407),b=s(8222),g=s(8793);let y=(0,r.default)(()=>Promise.all([s.e(212),s.e(590),s.e(566)]).then(s.bind(s,8995)),{loadableGenerated:{webpack:()=>[8995]},ssr:!1,loading:()=>(0,a.jsx)("div",{className:"w-full h-full bg-slate-100 animate-pulse rounded-2xl flex items-center justify-center text-slate-400",children:"地図を読み込み中..."})}),N=(0,r.default)(()=>s.e(435).then(s.bind(s,1435)),{loadableGenerated:{webpack:()=>[1435]},ssr:!1});function v(){let e=(0,i.useRouter)(),[t,s]=(0,l.useState)(null),[r,c]=(0,l.useState)(!0),[v,w]=(0,l.useState)(null),[_,k]=(0,l.useState)([]),[Z,P]=(0,l.useState)(!0),[S,M]=(0,l.useState)(0),[z,C]=(0,l.useState)(null),[E,L]=(0,l.useState)(null),[O,R]=(0,l.useState)(0),[A,D]=(0,l.useState)([]);(0,l.useEffect)(()=>{(0,g.ts)().then(e=>{s(null!=e?e:null),c(!1)})},[]),(0,l.useEffect)(()=>{if(!r&&t&&("admin"===t.role||"provider"===t.role)){e.replace("/admin");return}},[t,r,e]),(0,l.useEffect)(()=>{r||t||(0,b.v2)().then(k).finally(()=>P(!1))},[r,t]),(0,l.useEffect)(()=>{if(r||!t||"farmer"!==t.role)return;let e=!1;return P(!0),Promise.all([(0,b.g8)(),t.id?(0,b.ss)(t.id):Promise.resolve([])]).then(t=>{let[s,a]=t;e||(w(s),D(a),s&&(0,b.x1)(s.id).then(t=>{e||R(t)}),P(!1))}),()=>{e=!0}},[r,t]);let B=async e=>{var s,a;if(!v||!z){p.toast.error("案件情報または圃場データが不足しています");return}let l={base_price:v.base_price||0,min_price:v.min_price||0,target_area_10r:v.target_area_10r||0,min_target_area_10r:v.min_target_area_10r,max_target_area_10r:v.max_target_area_10r,execution_price:v.execution_price},r=O+S,n=null!==(a=null!==(s=(0,j.Bx)(l,r).currentPrice)&&void 0!==s?s:v.base_price)&&void 0!==a?a:0,i={campaign_id:v.id,farmer_id:(null==t?void 0:t.role)==="farmer"&&(null==t?void 0:t.id)?t.id:void 0,farmer_name:e.farmerName,phone:e.phone,email:e.email,desired_start_date:e.desiredStartDate,desired_end_date:e.desiredEndDate,field_polygon:z,area_10r:S,locked_price:n},d=await (0,b.TB)(i);d.success?(p.toast.success("予約が完了しました。予約ID: ".concat(d.bookingId)),M(0),C(null),L(null),(null==t?void 0:t.id)&&(0,b.ss)(t.id).then(D),window.location.reload()):p.toast.error(d.error||"予約に失敗しました")};if(r)return(0,a.jsx)("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsx)(d.Z,{className:"w-10 h-10 text-green-600 animate-spin"}),(0,a.jsx)("p",{className:"text-slate-600 font-medium",children:"読み込み中..."})]})});if(t&&("admin"===t.role||"provider"===t.role))return(0,a.jsx)("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsx)(d.Z,{className:"w-10 h-10 text-green-600 animate-spin"}),(0,a.jsx)("p",{className:"text-slate-600 font-medium",children:"ダッシュボードへ移動中..."})]})});if(!t)return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-green-50/30",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12",children:[(0,a.jsxs)("section",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-3xl md:text-4xl font-black text-slate-800 mb-3",children:(0,a.jsx)("span",{className:"text-[#16a34a]",children:"Wayfinder AgriX"})}),(0,a.jsx)("p",{className:"text-slate-600 font-medium max-w-xl mx-auto",children:"農家と業者をつなぐドローン農作業予約プラットフォーム。圃場を指定して簡単に申し込みできます。"}),(0,a.jsxs)(n.default,{href:"/login",className:"inline-flex items-center gap-2 mt-6 bg-[#16a34a] text-white px-6 py-3 rounded-2xl font-bold shadow-sm hover:opacity-90 transition-opacity",children:[(0,a.jsx)(o,{className:"w-5 h-5"}),"ログイン / 新規登録"]})]}),(0,a.jsxs)("section",{id:"campaigns",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-[#16a34a]"}),"公開案件一覧"]}),Z?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(d.Z,{className:"w-8 h-8 text-slate-400 animate-spin"})}):0===_.length?(0,a.jsx)("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-slate-200 text-center text-slate-500",children:"現在募集中の案件はありません。"}):(0,a.jsx)("ul",{className:"space-y-3",children:_.map(e=>(0,a.jsxs)("li",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-slate-800",children:e.campaign_title||e.location}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:e.start_date&&e.end_date?"".concat(e.start_date," ～ ").concat(e.end_date):e.location})]}),(0,a.jsxs)(n.default,{href:"/login",className:"inline-flex items-center gap-1 text-sm font-bold text-[#16a34a] hover:underline shrink-0",children:["申し込む ",(0,a.jsx)(u.Z,{className:"w-4 h-4"})]})]},e.id))})]})]})});if("farmer"!==t.role)return null;if(Z&&!v)return(0,a.jsx)("main",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsx)(d.Z,{className:"w-10 h-10 text-green-600 animate-spin"}),(0,a.jsx)("p",{className:"text-slate-600 font-medium",children:"読み込み中..."})]})});let F={confirmed:"確定",pending:"確認待ち",completed:"完了",canceled:"キャンセル"};return(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-green-50/30",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-8",children:[v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-[#16a34a]"}),(0,a.jsx)("p",{className:"text-slate-700 font-bold",children:"募集中の案件"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-200 flex items-center gap-1",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 text-blue-600"}),(0,a.jsxs)("span",{className:"text-blue-700 font-bold text-xs",children:["累計: ",O.toFixed(1)," 反"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-green-50 px-4 py-2 rounded-full border border-green-200",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-green-700 font-bold text-sm",children:"募集中"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-12",children:[(0,a.jsx)("section",{className:"order-2 lg:order-1",children:(0,a.jsxs)("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 h-[500px] lg:h-[700px] relative",children:[(0,a.jsxs)("div",{className:"absolute top-6 left-6 z-[1000] bg-white/95 backdrop-blur px-4 py-2 rounded-xl shadow-md border border-slate-200 flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-[#16a34a]"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-sm font-bold text-slate-600",children:"圃場を描画"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"地図上でクリックして圃場の範囲を指定"})]})]}),S>0&&(0,a.jsxs)("div",{className:"absolute top-6 right-6 z-[1000] bg-[#16a34a] text-white px-5 py-3 rounded-xl shadow-sm border-2 border-green-500 min-w-[180px]",children:[(0,a.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider mb-1 opacity-90",children:"選択面積"}),(0,a.jsxs)("div",{className:"text-3xl font-black",children:[S.toFixed(2)," ",(0,a.jsx)("span",{className:"text-sm font-normal opacity-90",children:"反"})]})]}),(0,a.jsx)("div",{className:"w-full h-full rounded-xl overflow-hidden",children:(0,a.jsx)(y,{onPolygonComplete:(e,t,s)=>{L(e),M(t),C(s)},initialPolygon:E||void 0})})]})}),(0,a.jsx)("section",{className:"order-1 lg:order-2",children:(0,a.jsx)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:(0,a.jsx)(N,{project:v,area10r:S,totalCampaignArea:O,onSubmit:B})})})]})]}):(0,a.jsxs)("div",{className:"mb-8 p-6 bg-white rounded-2xl shadow-sm border border-slate-200 text-center",children:[(0,a.jsx)(m.Z,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-slate-600 font-medium",children:"現在募集中の案件はありません"})]}),(0,a.jsxs)("section",{id:"applications",className:"mb-10",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5 text-[#16a34a]"}),"申込履歴"]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:0===A.length?(0,a.jsx)("div",{className:"p-6 text-center text-slate-500 text-sm",children:"まだ申込がありません。"}):(0,a.jsx)("ul",{className:"divide-y divide-slate-100",children:A.map(e=>{var t,s;return(0,a.jsx)("li",{className:"p-4 flex flex-wrap items-center justify-between gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-slate-800",children:(null===(t=e.project)||void 0===t?void 0:t.campaign_title)||(null===(s=e.project)||void 0===s?void 0:s.location)||e.campaign_id}),(0,a.jsxs)("p",{className:"text-sm text-slate-500",children:[e.area_10r," 反",null!=e.locked_price&&" \xb7 \xa5".concat((e.area_10r*e.locked_price).toLocaleString())," \xb7 ",F[e.status]||e.status,e.created_at&&" \xb7 ".concat(new Date(e.created_at).toLocaleDateString("ja-JP"))]})]})},e.id)})})})]}),(0,a.jsxs)("section",{id:"my-field",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center gap-2",children:[(0,a.jsx)(f,{className:"w-5 h-5 text-[#16a34a]"}),"My畑管理"]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 text-center",children:(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"圃場情報の登録・管理は今後提供予定です。"})})]}),(0,a.jsx)("footer",{className:"mt-8 text-center text-sm text-slate-500",children:(0,a.jsx)("p",{children:"ご不明な点がございましたら、お気軽にお問い合わせください。"})})]})})}}},function(e){e.O(0,[866,755,250,288,11,121,971,69,744],function(){return e(e.s=5441)}),_N_E=e.O()}]);