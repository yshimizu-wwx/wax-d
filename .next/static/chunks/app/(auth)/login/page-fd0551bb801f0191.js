(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{6284:function(e,r,t){Promise.resolve().then(t.bind(t,3679))},7461:function(e,r,t){"use strict";t.d(r,{Z:function(){return i}});var a=t(4090),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,r)=>{let t=(0,a.forwardRef)((t,i)=>{let{color:o="currentColor",size:l=24,strokeWidth:d=2,absoluteStrokeWidth:c,className:u="",children:h,...m}=t;return(0,a.createElement)("svg",{ref:i,...s,width:l,height:l,stroke:o,strokeWidth:c?24*Number(d)/Number(l):d,className:["lucide","lucide-".concat(n(e)),u].join(" "),...m},[...r.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(h)?h:[h]])});return t.displayName="".concat(e),t}},6578:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8994:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2244:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]])},1213:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},3679:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return p}});var a=t(3827),s=t(4090),n=t(4958),i=t(5671),o=t(2782),l=t(575),d=t(2647),c=t(7461);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,c.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var h=t(6578),m=t(8994),f=t(2244),x=t(1213);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let b=(0,c.Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),g=(0,c.Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function p(){let[e,r]=(0,s.useState)(!0),[t,c]=(0,s.useState)(!1),[p,v]=(0,s.useState)(null),[y,w]=(0,s.useState)(null),[j,N]=(0,s.useState)({email:"",password:"",name:"",phone:"",role:"farmer",invitationCode:""}),k=async e=>{e.preventDefault(),c(!0),v(null);try{let{error:e}=await n.O.auth.signInWithPassword({email:j.email,password:j.password});if(e)throw e;let{data:r,error:t}=await n.O.from("users").select("*").eq("email",j.email).single();if(t||!r)throw await n.O.auth.signOut(),Error((null==t?void 0:t.code)==="PGRST116"?"このメールアドレスは登録されていません。新規登録をお試しください。":(null==t?void 0:t.message)||"ユーザー情報の取得に失敗しました。");if("pending"===r.status){v("メール認証が完了していません。届いたメールを確認してください。"),await n.O.auth.signOut();return}if("provider"===r.role&&"under_review"===r.status){v("アカウントは審査中です。管理者による承認後、ログインが可能になります。"),await n.O.auth.signOut();return}if("suspended"===r.status||"rejected"===r.status){v("このアカウントは現在利用できません。"),await n.O.auth.signOut();return}let a="admin"===r.role?"/admin":"provider"===r.role?"/admin":"/";window.location.href=a}catch(e){v(e instanceof Error?e.message:"ログインに失敗しました")}finally{c(!1)}},C=async e=>{e.preventDefault(),c(!0),v(null),w(null);try{let{data:e}=await n.O.from("users").select("email").eq("email",j.email).single();if(e){v("このメールアドレスは既に登録されています");return}let{error:r}=await n.O.auth.signUp({email:j.email,password:j.password,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback"),data:{name:j.name,phone:j.phone,role:j.role,invitation_code:j.invitationCode}}});if(r)throw r;let t=("farmer"===j.role?"F":"P")+Date.now(),a="provider"===j.role?t:null;if("farmer"===j.role&&j.invitationCode){let{data:e}=await n.O.from("users").select("id").eq("invitation_code",j.invitationCode).eq("role","provider").single();e&&(a=e.id)}let{error:s}=await n.O.from("users").insert({id:t,email:j.email,role:j.role,name:j.name,phone:j.phone,status:"pending",associated_provider_id:a,invitation_code:j.invitationCode||null});if(s)throw s;w("確認メールを送信しました。メール内のリンクをクリックして登録を完了してください。"),N({email:"",password:"",name:"",phone:"",role:"farmer",invitationCode:""})}catch(e){v(e instanceof Error?e.message:"登録に失敗しました")}finally{c(!1)}};return(0,a.jsx)("main",{className:"min-h-screen w-full flex flex-col items-center justify-center p-4 bg-dashboard-bg bg-gradient-to-br from-dashboard-bg via-agrix-forest/[0.06] to-dashboard-bg",children:(0,a.jsxs)("div",{className:"w-full max-w-md flex flex-col items-center",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsxs)("h1",{className:"text-3xl font-black text-dashboard-text tracking-tight flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{className:"text-agrix-forest","aria-hidden":!0,children:"\uD83C\uDF3E"}),"Wayfinder AgriX Drone"]}),(0,a.jsx)("p",{className:"text-dashboard-muted font-medium mt-2 text-base",children:"農家と業者をつなぐプラットフォーム"})]}),(0,a.jsxs)(i.Zb,{className:"w-full max-w-md border border-dashboard-border shadow-xl overflow-hidden rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex border-b border-dashboard-border",children:[(0,a.jsx)(l.z,{type:"button",variant:e?"default":"ghost",className:"flex-1 rounded-none h-12 font-bold ".concat(e?"bg-agrix-forest text-white hover:bg-agrix-forest-light shadow-none":"bg-dashboard-bg text-dashboard-muted hover:bg-dashboard-border hover:text-dashboard-text"),onClick:()=>{r(!0),v(null),w(null)},children:"ログイン"}),(0,a.jsx)(l.z,{type:"button",variant:e?"ghost":"default",className:"flex-1 rounded-none h-12 font-bold ".concat(e?"bg-dashboard-bg text-dashboard-muted hover:bg-dashboard-border hover:text-dashboard-text":"bg-agrix-forest text-white hover:bg-agrix-forest-light shadow-none"),onClick:()=>{r(!1),v(null),w(null)},children:"新規登録"})]}),(0,a.jsxs)(i.aY,{className:"p-6",children:[p&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-destructive/10 border border-destructive/30 rounded-xl text-destructive text-sm font-medium flex items-start gap-2",children:[(0,a.jsx)(u,{className:"w-5 h-5 shrink-0 mt-0.5"}),(0,a.jsx)("span",{children:p})]}),y&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-agrix-forest/10 border border-agrix-forest/30 rounded-xl text-agrix-forest text-sm font-medium flex items-start gap-2",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5 shrink-0 mt-0.5"}),(0,a.jsx)("span",{children:y})]}),e?(0,a.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"login-email",children:"メールアドレス"}),(0,a.jsx)(o.I,{id:"login-email",type:"email",value:j.email,onChange:e=>N({...j,email:e.target.value}),placeholder:"example@example.com",required:!0,className:"border-dashboard-border bg-dashboard-card"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"login-password",children:"パスワード"}),(0,a.jsx)(o.I,{id:"login-password",type:"password",value:j.password,onChange:e=>N({...j,password:e.target.value}),placeholder:"••••••••",required:!0,className:"border-dashboard-border bg-dashboard-card"})]}),(0,a.jsx)(l.z,{type:"submit",disabled:t,className:"w-full h-12 font-bold rounded-xl bg-agrix-forest text-white hover:bg-agrix-forest-light border-0",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 animate-spin"})," ログイン中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"w-4 h-4"})," ログイン"]})})]}):(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{children:"ユーザー種別"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(l.z,{type:"button",variant:"farmer"===j.role?"default":"secondary",className:"farmer"===j.role?"bg-agrix-forest text-white hover:bg-agrix-forest-light border-0":"",onClick:()=>N({...j,role:"farmer"}),children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"})," 農家"]}),(0,a.jsxs)(l.z,{type:"button",variant:"provider"===j.role?"accent":"secondary",className:"provider"===j.role?"bg-agrix-gold text-agrix-forest hover:bg-agrix-gold-light border-0":"",onClick:()=>N({...j,role:"provider"}),children:[(0,a.jsx)(b,{className:"w-4 h-4"})," 業者"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"signup-name",children:"お名前"}),(0,a.jsx)(o.I,{id:"signup-name",type:"text",value:j.name,onChange:e=>N({...j,name:e.target.value}),placeholder:"山田 太郎",required:!0,className:"border-dashboard-border bg-dashboard-card"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"signup-phone",children:"電話番号"}),(0,a.jsx)(o.I,{id:"signup-phone",type:"tel",value:j.phone,onChange:e=>N({...j,phone:e.target.value}),placeholder:"090-1234-5678",required:!0,className:"border-dashboard-border bg-dashboard-card"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"signup-email",children:"メールアドレス"}),(0,a.jsx)(o.I,{id:"signup-email",type:"email",value:j.email,onChange:e=>N({...j,email:e.target.value}),placeholder:"example@example.com",required:!0,className:"border-dashboard-border bg-dashboard-card"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"signup-password",children:"パスワード"}),(0,a.jsx)(o.I,{id:"signup-password",type:"password",value:j.password,onChange:e=>N({...j,password:e.target.value}),placeholder:"8文字以上",required:!0,minLength:8,className:"border-dashboard-border bg-dashboard-card"})]}),"farmer"===j.role&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{htmlFor:"signup-invitation",children:"招待コード（任意）"}),(0,a.jsx)(o.I,{id:"signup-invitation",type:"text",value:j.invitationCode,onChange:e=>N({...j,invitationCode:e.target.value}),placeholder:"業者から受け取った招待コード",className:"border-dashboard-border bg-dashboard-card"}),(0,a.jsx)("p",{className:"text-xs text-dashboard-muted",children:"業者から招待コードを受け取っている場合は入力してください"})]}),(0,a.jsx)(l.z,{type:"submit",disabled:t,className:"w-full h-12 font-bold rounded-xl bg-agrix-forest text-white hover:bg-agrix-forest-light border-0",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 animate-spin"})," 登録中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{className:"w-4 h-4"})," 新規登録"]})})]})]})]}),(0,a.jsxs)("p",{className:"text-dashboard-muted text-sm mt-6 text-center",children:["\xa9 2026"," ",(0,a.jsx)("a",{href:"https://wayfinderworx.com/",target:"_blank",rel:"noopener noreferrer",className:"text-dashboard-text hover:text-agrix-forest underline underline-offset-2",children:"Wayfinder WorX"}),"."]})]})})}},575:function(e,r,t){"use strict";t.d(r,{z:function(){return l}});var a=t(3827),s=t(4090),n=t(9769),i=t(2169);let o=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-bold tracking-tight transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:pointer-events-none disabled:opacity-50 [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",accent:"bg-accent text-accent-foreground hover:bg-accent/80 shadow-sm",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary bg-transparent text-primary hover:bg-primary/10",secondary:"bg-muted text-muted-foreground hover:bg-muted/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-11 px-5 py-2",sm:"h-9 rounded-md px-3 text-xs",lg:"h-12 rounded-lg px-8 text-base",icon:"h-10 w-10","icon-sm":"h-8 w-8","icon-lg":"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,r)=>{let{className:t,variant:s,size:n,...l}=e;return(0,a.jsx)("button",{className:(0,i.cn)(o({variant:s,size:n,className:t})),ref:r,...l})});l.displayName="Button"},5671:function(e,r,t){"use strict";t.d(r,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return l}});var a=t(3827),s=t(4090),n=t(2169);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border border-border bg-card text-card-foreground shadow-sm",t),...s})});i.displayName="Card";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});o.displayName="CardHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,n.cn)("text-lg font-bold leading-none tracking-tight text-card-foreground",t),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},2782:function(e,r,t){"use strict";t.d(r,{I:function(){return i}});var a=t(3827),s=t(4090),n=t(2169);let i=s.forwardRef((e,r)=>{let{className:t,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-11 w-full rounded-lg border border-border bg-card px-4 py-2 text-sm font-medium text-foreground ring-offset-background transition-colors","placeholder:text-muted-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:border-primary","disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...i})});i.displayName="Input"},2647:function(e,r,t){"use strict";t.d(r,{_:function(){return i}});var a=t(3827),s=t(4090),n=t(2169);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("label",{ref:r,className:(0,n.cn)("block text-sm font-bold text-foreground leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...s})});i.displayName="Label"},4958:function(e,r,t){"use strict";t.d(r,{O:function(){return a}});let a=(0,t(342).createBrowserClient)("https://ayvieorwnyxxfygbhzny.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5dmllb3J3bnl4eGZ5Z2Joem55Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MjY1OTUsImV4cCI6MjA4NjQwMjU5NX0.-alPp1Cr1J2yoKcdaln4LMbOPjaGCb4wRjURGhibLPk")},2169:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var a=t(3167),s=t(1367);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,a.W)(r))}},9769:function(e,r,t){"use strict";t.d(r,{j:function(){return i}});var a=t(3167);let s=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,n=a.W,i=(e,r)=>t=>{var a;if((null==r?void 0:r.variants)==null)return n(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:i,defaultVariants:o}=r,l=Object.keys(i).map(e=>{let r=null==t?void 0:t[e],a=null==o?void 0:o[e];if(null===r)return null;let n=s(r)||s(a);return i[e][n]}),d=t&&Object.entries(t).reduce((e,r)=>{let[t,a]=r;return void 0===a||(e[t]=a),e},{});return n(e,l,null==r?void 0:null===(a=r.compoundVariants)||void 0===a?void 0:a.reduce((e,r)=>{let{class:t,className:a,...s}=r;return Object.entries(s).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...o,...d}[r]):({...o,...d})[r]===t})?[...e,t,a]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)}}},function(e){e.O(0,[342,150,971,69,744],function(){return e(e.s=6284)}),_N_E=e.O()}]);