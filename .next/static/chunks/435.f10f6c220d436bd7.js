"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[435],{1435:function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});var a=s(3827),r=s(4090),l=s(6288),d=s(407);function n(e){var t,s;let{project:n,area10r:i,totalCampaignArea:c,onSubmit:o}=e,[x,m]=(0,r.useState)({farmerName:"",phone:"",email:"",desiredStartDate:"",desiredEndDate:""}),[b,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)({}),u={base_price:n.base_price||0,min_price:n.min_price||0,target_area_10r:n.target_area_10r||0,min_target_area_10r:n.min_target_area_10r,max_target_area_10r:n.max_target_area_10r,execution_price:n.execution_price},j=(0,d.Bx)(u,c+i),N=null!==(s=null!==(t=j.currentPrice)&&void 0!==t?t:n.base_price)&&void 0!==s?s:0,f=(0,d.MR)(N,i),v=(0,d.km)(f),_=(e,t)=>{m(s=>({...s,[e]:t})),p[e]&&g(t=>({...t,[e]:void 0}))},w=()=>{let e={};return x.farmerName.trim()||(e.farmerName="農家名を入力してください"),x.phone.trim()?/^[\d-]+$/.test(x.phone)||(e.phone="有効な電話番号を入力してください"):e.phone="電話番号を入力してください",x.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x.email)||(e.email="有効なメールアドレスを入力してください"):e.email="メールアドレスを入力してください",x.desiredStartDate||(e.desiredStartDate="開始日を選択してください"),x.desiredEndDate||(e.desiredEndDate="終了日を選択してください"),x.desiredStartDate&&x.desiredEndDate&&x.desiredStartDate>x.desiredEndDate&&(e.desiredEndDate="終了日は開始日以降を選択してください"),g(e),0===Object.keys(e).length},y=async e=>{if(e.preventDefault(),w()){if(i<=0){l.toast.error("地図上で圃場を描画してください");return}h(!0);try{await o(x)}catch(e){console.error("Submission error:",e),l.toast.error("予約の送信に失敗しました。もう一度お試しください。")}finally{h(!1)}}};return(0,a.jsxs)("form",{onSubmit:y,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-2xl border border-green-200",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-2 flex items-center",children:[(0,a.jsx)("i",{className:"w-1 h-6 bg-green-500 rounded-full mr-3 block"}),n.campaign_title||n.title||"案件情報"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-500 mb-1",children:"場所"}),(0,a.jsx)("div",{className:"font-bold text-slate-800",children:n.location})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-500 mb-1",children:"作業期間"}),(0,a.jsx)("div",{className:"font-bold text-slate-800",children:n.start_date&&n.end_date?"".concat(n.start_date," 〜 ").concat(n.end_date):"未定"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide pb-2 border-b border-slate-200",children:"農家情報"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["農家名 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"text",value:x.farmerName,onChange:e=>_("farmerName",e.target.value),placeholder:"例: 山田農園",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(p.farmerName?"border-red-500":"border-slate-200")}),p.farmerName&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:p.farmerName})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["電話番号 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"tel",value:x.phone,onChange:e=>_("phone",e.target.value),placeholder:"例: 090-1234-5678",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(p.phone?"border-red-500":"border-slate-200")}),p.phone&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:p.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["メールアドレス ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"email",value:x.email,onChange:e=>_("email",e.target.value),placeholder:"例: yamada@example.com",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(p.email?"border-red-500":"border-slate-200")}),p.email&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:p.email})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide pb-2 border-b border-slate-200",children:"希望作業日"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["開始日 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"date",value:x.desiredStartDate,onChange:e=>_("desiredStartDate",e.target.value),className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(p.desiredStartDate?"border-red-500":"border-slate-200")}),p.desiredStartDate&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:p.desiredStartDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["終了日 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"date",value:x.desiredEndDate,onChange:e=>_("desiredEndDate",e.target.value),className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(p.desiredEndDate?"border-red-500":"border-slate-200")}),p.desiredEndDate&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:p.desiredEndDate})]})]})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-6 rounded-2xl border border-green-200",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide pb-2 border-b border-green-300 mb-4",children:"圃場面積"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-4xl font-black text-green-600",children:[i.toFixed(2)," ",(0,a.jsx)("span",{className:"text-lg font-normal text-green-500",children:"反 (10a)"})]}),0===i&&(0,a.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:"地図上で圃場を描画してください"})]})]}),(0,a.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-6 text-white space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-wide pb-2 border-b border-slate-700",children:"現在の単価・料金"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-slate-400 text-sm font-bold uppercase tracking-wider mb-1",children:"現在の単価"}),(0,a.jsxs)("div",{className:"text-4xl font-black text-agrix-gold flex justify-center items-baseline gap-1 animate-price-pulse",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\xa5"}),null==N?void 0:N.toLocaleString(),(0,a.jsx)("span",{className:"text-sm font-normal text-slate-400 ml-1",children:"/ 10a"})]},N),j.isUnformed&&(0,a.jsx)("div",{className:"text-red-400 text-xs font-bold mt-2",children:"⚠️ 最低成立面積に達していません"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 border-t border-slate-700 pt-4 mt-4",children:[(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"text-slate-400 text-xs",children:"合計金額（税抜）"}),(0,a.jsxs)("div",{className:"font-bold text-lg",children:["\xa5",f.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-slate-400 text-xs",children:"合計金額（税込）"}),(0,a.jsxs)("div",{className:"font-bold text-xl text-yellow-400",children:["\xa5",v.amountInclusive.toLocaleString()]})]})]})]}),(0,a.jsx)("button",{type:"submit",disabled:b||i<=0,className:"w-full bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-5 px-8 rounded-2xl hover:from-green-600 hover:to-green-700 disabled:from-slate-300 disabled:to-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl text-lg",children:b?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"送信中..."]}):"予約する"})]})}}}]);