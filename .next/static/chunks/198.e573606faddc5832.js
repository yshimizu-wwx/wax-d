"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{3879:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4198:function(e,t,s){s.r(t),s.d(t,{default:function(){return o}});var a=s(3827),l=s(4090),r=s(6288),n=s(407),d=s(8025),i=s(3879);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,s(7461).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function o(e){var t,s,o,x,m,h,u,p,b,g;let{project:j,area10r:f,totalCampaignArea:N,onSubmit:v,initialFormData:w}=e,[y,_]=(0,l.useState)(1),[k,D]=(0,l.useState)({farmerName:null!==(t=null==w?void 0:w.farmerName)&&void 0!==t?t:"",phone:null!==(s=null==w?void 0:w.phone)&&void 0!==s?s:"",email:null!==(o=null==w?void 0:w.email)&&void 0!==o?o:"",desiredStartDate:null!==(x=null==w?void 0:w.desiredStartDate)&&void 0!==x?x:"",desiredEndDate:null!==(m=null==w?void 0:w.desiredEndDate)&&void 0!==m?m:""}),[S,C]=(0,l.useState)(!1),[E,Z]=(0,l.useState)({}),L={base_price:j.base_price||0,min_price:j.min_price||0,target_area_10r:j.target_area_10r||0,min_target_area_10r:null!==(h=j.min_target_area_10r)&&void 0!==h?h:void 0,max_target_area_10r:null!==(u=j.max_target_area_10r)&&void 0!==u?u:void 0,execution_price:null!==(p=j.execution_price)&&void 0!==p?p:void 0},M=(0,n.Bx)(L,N+f),z=null!==(g=null!==(b=M.currentPrice)&&void 0!==b?b:j.base_price)&&void 0!==g?g:0,F=(0,n.MR)(z,f),A=(0,n.km)(F),B=(e,t)=>{D(s=>({...s,[e]:t})),E[e]&&Z(t=>({...t,[e]:void 0}))},H=()=>{let e={};return k.farmerName.trim()||(e.farmerName="お名前を入力しましょう"),k.phone.trim()?/^[\d-]+$/.test(k.phone)||(e.phone="有効な電話番号を入力してください"):e.phone="電話番号を入力しましょう",k.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(k.email)||(e.email="有効なメールアドレスを入力してください"):e.email="メールアドレスを入力しましょう",Z(e),0===Object.keys(e).length},O=()=>{let e={};return k.desiredStartDate||(e.desiredStartDate="開始日を選びましょう"),k.desiredEndDate||(e.desiredEndDate="終了日を選びましょう"),k.desiredStartDate&&k.desiredEndDate&&k.desiredStartDate>k.desiredEndDate&&(e.desiredEndDate="終了日は開始日以降にしてください"),Z(e),0===Object.keys(e).length},$=async e=>{if(e.preventDefault(),3===y){if(!H()){_(1);return}if(!O()){_(2);return}if(f<=0){r.toast.error("地図上で圃場を描画してください");return}C(!0);try{await v(k)}catch(e){console.error("Submission error:",e),r.toast.error("予約の送信に失敗しました。もう一度お試しください。")}finally{C(!1)}}},I=1===y?"農家情報":2===y?"希望作業日":"確認";return(0,a.jsxs)("form",{onSubmit:$,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-slate-500",children:["Step ",y,"/",3]}),(0,a.jsx)("div",{className:"h-1.5 w-full rounded-full bg-slate-200 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full rounded-full bg-green-500 transition-all duration-300 ease-out",style:{width:"".concat(y/3*100,"%")}})})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-2xl border border-green-200",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-2 flex items-center",children:[(0,a.jsx)("span",{className:"w-1 h-6 bg-green-500 rounded-full mr-3 block"}),j.campaign_title||j.title||"案件情報"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-500 mb-1",children:"場所"}),(0,a.jsx)("div",{className:"font-bold text-slate-800",children:j.location})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-500 mb-1",children:"作業期間"}),(0,a.jsx)("div",{className:"font-bold text-slate-800",children:j.start_date&&j.end_date?"".concat(j.start_date," 〜 ").concat(j.end_date):"未定"})]})]})]}),(0,a.jsx)("div",{className:"overflow-hidden transition-all duration-300 ease-out ".concat(1===y?"opacity-100 max-h-[9999px]":"opacity-0 max-h-0 pointer-events-none"),children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide pb-2 border-b border-slate-200",children:I}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["農家名 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"text",value:k.farmerName,onChange:e=>B("farmerName",e.target.value),placeholder:"農園名やお名前を教えてください",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(E.farmerName?"border-red-500":"border-slate-200")}),E.farmerName&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:E.farmerName})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["電話番号 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"tel",value:k.phone,onChange:e=>B("phone",e.target.value),placeholder:"連絡のつく番号を入力しましょう",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(E.phone?"border-red-500":"border-slate-200")}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"作業のご連絡に使います"}),E.phone&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:E.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["メールアドレス ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"email",value:k.email,onChange:e=>B("email",e.target.value),placeholder:"ログインに使うメールアドレスは？",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(E.email?"border-red-500":"border-slate-200")}),E.email&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:E.email})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-2",children:(0,a.jsxs)("button",{type:"button",onClick:()=>H()&&_(2),className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-green-500 text-white font-bold hover:bg-green-600 transition-all duration-200 hover:shadow-lg",children:["次へ進む ",(0,a.jsx)(d.Z,{className:"w-4 h-4"})]})})]})}),(0,a.jsx)("div",{className:"overflow-hidden transition-all duration-300 ease-out ".concat(2===y?"opacity-100 max-h-[9999px]":"opacity-0 max-h-0 pointer-events-none"),children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between pb-2 border-b border-slate-200",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide",children:I}),(0,a.jsxs)("button",{type:"button",onClick:()=>_(1),className:"text-sm text-slate-500 hover:text-slate-700 inline-flex items-center gap-1",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"})," 戻る"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["開始日 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"date",value:k.desiredStartDate,onChange:e=>B("desiredStartDate",e.target.value),className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(E.desiredStartDate?"border-red-500":"border-slate-200")}),E.desiredStartDate&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:E.desiredStartDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["終了日 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"date",value:k.desiredEndDate,onChange:e=>B("desiredEndDate",e.target.value),className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(E.desiredEndDate?"border-red-500":"border-slate-200")}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"案件の期間内で選んでください"}),E.desiredEndDate&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:E.desiredEndDate})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-2",children:(0,a.jsxs)("button",{type:"button",onClick:()=>O()&&_(3),className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-green-500 text-white font-bold hover:bg-green-600 transition-all duration-200 hover:shadow-lg",children:["次へ進む ",(0,a.jsx)(d.Z,{className:"w-4 h-4"})]})})]})}),(0,a.jsx)("div",{className:"overflow-hidden transition-all duration-300 ease-out ".concat(3===y?"opacity-100 max-h-[9999px]":"opacity-0 max-h-0 pointer-events-none"),children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide",children:I}),(0,a.jsxs)("button",{type:"button",onClick:()=>_(2),className:"text-sm text-slate-500 hover:text-slate-700 inline-flex items-center gap-1",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"})," 戻る"]})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-4 rounded-2xl border border-slate-200 space-y-2 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"お名前"})," ",k.farmerName]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"電話"})," ",k.phone]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"メール"})," ",k.email]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"希望期間"})," ",k.desiredStartDate," 〜 ",k.desiredEndDate]})]}),(0,a.jsx)("div",{className:"bg-green-50 p-6 rounded-2xl border border-green-200",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-4xl font-black text-green-600",children:[f.toFixed(2)," ",(0,a.jsx)("span",{className:"text-lg font-normal text-green-500",children:"反 (10a)"})]}),0===f&&(0,a.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:"地図上で圃場を描画してください"})]})}),(0,a.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-6 text-white space-y-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-slate-400 text-sm font-bold uppercase tracking-wider mb-1",children:"現在の単価"}),(0,a.jsxs)("div",{className:"text-4xl font-black text-yellow-400 flex justify-center items-baseline gap-1 animate-price-pulse",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\xa5"}),null==z?void 0:z.toLocaleString(),(0,a.jsx)("span",{className:"text-sm font-normal text-slate-400 ml-1",children:"/ 10a"})]},z),M.isUnformed&&(0,a.jsx)("div",{className:"text-red-400 text-xs font-bold mt-2",children:"⚠️ 最低成立面積に達していません"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 border-t border-slate-700 pt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-400 text-xs",children:"合計（税抜）"}),(0,a.jsxs)("div",{className:"font-bold text-lg",children:["\xa5",F.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-slate-400 text-xs",children:"合計（税込）"}),(0,a.jsxs)("div",{className:"font-bold text-xl text-yellow-400",children:["\xa5",A.amountInclusive.toLocaleString()]})]})]})]}),(0,a.jsx)("button",{type:"submit",disabled:S||f<=0,className:"w-full bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-5 px-8 rounded-2xl hover:from-green-600 hover:to-green-700 disabled:from-slate-300 disabled:to-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl text-lg inline-flex items-center justify-center gap-2",children:S?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"送信中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c,{className:"w-5 h-5"})," 申し込みを完了する"]})})]})})]})}}}]);