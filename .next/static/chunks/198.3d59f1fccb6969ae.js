"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{3879:function(e,t,s){s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(7461).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4198:function(e,t,s){s.r(t),s.d(t,{default:function(){return o}});var a=s(3827),l=s(4090),r=s(6288),n=s(407),d=s(8025),i=s(3879);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,s(7461).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function o(e){var t,s,o,x,m;let{project:h,area10r:p,totalCampaignArea:u,onSubmit:b}=e,[g,j]=(0,l.useState)(1),[f,N]=(0,l.useState)({farmerName:"",phone:"",email:"",desiredStartDate:"",desiredEndDate:""}),[v,w]=(0,l.useState)(!1),[y,_]=(0,l.useState)({}),k={base_price:h.base_price||0,min_price:h.min_price||0,target_area_10r:h.target_area_10r||0,min_target_area_10r:null!==(t=h.min_target_area_10r)&&void 0!==t?t:void 0,max_target_area_10r:null!==(s=h.max_target_area_10r)&&void 0!==s?s:void 0,execution_price:null!==(o=h.execution_price)&&void 0!==o?o:void 0},D=(0,n.Bx)(k,u+p),S=null!==(m=null!==(x=D.currentPrice)&&void 0!==x?x:h.base_price)&&void 0!==m?m:0,C=(0,n.MR)(S,p),E=(0,n.km)(C),Z=(e,t)=>{N(s=>({...s,[e]:t})),y[e]&&_(t=>({...t,[e]:void 0}))},L=()=>{let e={};return f.farmerName.trim()||(e.farmerName="お名前を入力しましょう"),f.phone.trim()?/^[\d-]+$/.test(f.phone)||(e.phone="有効な電話番号を入力してください"):e.phone="電話番号を入力しましょう",f.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.email)||(e.email="有効なメールアドレスを入力してください"):e.email="メールアドレスを入力しましょう",_(e),0===Object.keys(e).length},M=()=>{let e={};return f.desiredStartDate||(e.desiredStartDate="開始日を選びましょう"),f.desiredEndDate||(e.desiredEndDate="終了日を選びましょう"),f.desiredStartDate&&f.desiredEndDate&&f.desiredStartDate>f.desiredEndDate&&(e.desiredEndDate="終了日は開始日以降にしてください"),_(e),0===Object.keys(e).length},z=async e=>{if(e.preventDefault(),3===g){if(!L()){j(1);return}if(!M()){j(2);return}if(p<=0){r.toast.error("地図上で圃場を描画してください");return}w(!0);try{await b(f)}catch(e){console.error("Submission error:",e),r.toast.error("予約の送信に失敗しました。もう一度お試しください。")}finally{w(!1)}}},F=1===g?"農家情報":2===g?"希望作業日":"確認";return(0,a.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-slate-500",children:["Step ",g,"/",3]}),(0,a.jsx)("div",{className:"h-1.5 w-full rounded-full bg-slate-200 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full rounded-full bg-green-500 transition-all duration-300 ease-out",style:{width:"".concat(g/3*100,"%")}})})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-2xl border border-green-200",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-2 flex items-center",children:[(0,a.jsx)("span",{className:"w-1 h-6 bg-green-500 rounded-full mr-3 block"}),h.campaign_title||h.title||"案件情報"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-500 mb-1",children:"場所"}),(0,a.jsx)("div",{className:"font-bold text-slate-800",children:h.location})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-500 mb-1",children:"作業期間"}),(0,a.jsx)("div",{className:"font-bold text-slate-800",children:h.start_date&&h.end_date?"".concat(h.start_date," 〜 ").concat(h.end_date):"未定"})]})]})]}),(0,a.jsx)("div",{className:"overflow-hidden transition-all duration-300 ease-out ".concat(1===g?"opacity-100 max-h-[9999px]":"opacity-0 max-h-0 pointer-events-none"),children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide pb-2 border-b border-slate-200",children:F}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["農家名 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"text",value:f.farmerName,onChange:e=>Z("farmerName",e.target.value),placeholder:"農園名やお名前を教えてください",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(y.farmerName?"border-red-500":"border-slate-200")}),y.farmerName&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:y.farmerName})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["電話番号 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"tel",value:f.phone,onChange:e=>Z("phone",e.target.value),placeholder:"連絡のつく番号を入力しましょう",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(y.phone?"border-red-500":"border-slate-200")}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"作業のご連絡に使います"}),y.phone&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:y.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["メールアドレス ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"email",value:f.email,onChange:e=>Z("email",e.target.value),placeholder:"ログインに使うメールアドレスは？",className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(y.email?"border-red-500":"border-slate-200")}),y.email&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:y.email})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-2",children:(0,a.jsxs)("button",{type:"button",onClick:()=>L()&&j(2),className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-green-500 text-white font-bold hover:bg-green-600 transition-all duration-200 hover:shadow-lg",children:["次へ進む ",(0,a.jsx)(d.Z,{className:"w-4 h-4"})]})})]})}),(0,a.jsx)("div",{className:"overflow-hidden transition-all duration-300 ease-out ".concat(2===g?"opacity-100 max-h-[9999px]":"opacity-0 max-h-0 pointer-events-none"),children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between pb-2 border-b border-slate-200",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide",children:F}),(0,a.jsxs)("button",{type:"button",onClick:()=>j(1),className:"text-sm text-slate-500 hover:text-slate-700 inline-flex items-center gap-1",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"})," 戻る"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["開始日 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"date",value:f.desiredStartDate,onChange:e=>Z("desiredStartDate",e.target.value),className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(y.desiredStartDate?"border-red-500":"border-slate-200")}),y.desiredStartDate&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:y.desiredStartDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:["終了日 ",(0,a.jsx)("span",{className:"text-red-600 text-xs ml-1",children:"必須"})]}),(0,a.jsx)("input",{type:"date",value:f.desiredEndDate,onChange:e=>Z("desiredEndDate",e.target.value),className:"w-full p-4 bg-slate-50 rounded-xl border outline-none focus:ring-2 focus:ring-green-500 ".concat(y.desiredEndDate?"border-red-500":"border-slate-200")}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"案件の期間内で選んでください"}),y.desiredEndDate&&(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:y.desiredEndDate})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-2",children:(0,a.jsxs)("button",{type:"button",onClick:()=>M()&&j(3),className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-green-500 text-white font-bold hover:bg-green-600 transition-all duration-200 hover:shadow-lg",children:["次へ進む ",(0,a.jsx)(d.Z,{className:"w-4 h-4"})]})})]})}),(0,a.jsx)("div",{className:"overflow-hidden transition-all duration-300 ease-out ".concat(3===g?"opacity-100 max-h-[9999px]":"opacity-0 max-h-0 pointer-events-none"),children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wide",children:F}),(0,a.jsxs)("button",{type:"button",onClick:()=>j(2),className:"text-sm text-slate-500 hover:text-slate-700 inline-flex items-center gap-1",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"})," 戻る"]})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-4 rounded-2xl border border-slate-200 space-y-2 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"お名前"})," ",f.farmerName]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"電話"})," ",f.phone]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"メール"})," ",f.email]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-slate-500",children:"希望期間"})," ",f.desiredStartDate," 〜 ",f.desiredEndDate]})]}),(0,a.jsx)("div",{className:"bg-green-50 p-6 rounded-2xl border border-green-200",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-4xl font-black text-green-600",children:[p.toFixed(2)," ",(0,a.jsx)("span",{className:"text-lg font-normal text-green-500",children:"反 (10a)"})]}),0===p&&(0,a.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:"地図上で圃場を描画してください"})]})}),(0,a.jsxs)("div",{className:"bg-slate-900 rounded-2xl p-6 text-white space-y-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-slate-400 text-sm font-bold uppercase tracking-wider mb-1",children:"現在の単価"}),(0,a.jsxs)("div",{className:"text-4xl font-black text-yellow-400 flex justify-center items-baseline gap-1 animate-price-pulse",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\xa5"}),null==S?void 0:S.toLocaleString(),(0,a.jsx)("span",{className:"text-sm font-normal text-slate-400 ml-1",children:"/ 10a"})]},S),D.isUnformed&&(0,a.jsx)("div",{className:"text-red-400 text-xs font-bold mt-2",children:"⚠️ 最低成立面積に達していません"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 border-t border-slate-700 pt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-400 text-xs",children:"合計（税抜）"}),(0,a.jsxs)("div",{className:"font-bold text-lg",children:["\xa5",C.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-slate-400 text-xs",children:"合計（税込）"}),(0,a.jsxs)("div",{className:"font-bold text-xl text-yellow-400",children:["\xa5",E.amountInclusive.toLocaleString()]})]})]})]}),(0,a.jsx)("button",{type:"submit",disabled:v||p<=0,className:"w-full bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-5 px-8 rounded-2xl hover:from-green-600 hover:to-green-700 disabled:from-slate-300 disabled:to-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl text-lg inline-flex items-center justify-center gap-2",children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"送信中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c,{className:"w-5 h-5"})," 申し込みを完了する"]})})]})})]})}}}]);