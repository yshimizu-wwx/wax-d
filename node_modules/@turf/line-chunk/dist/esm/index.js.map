{"version":3,"sources":["../../index.ts"],"sourcesContent":["import { length } from \"@turf/length\";\nimport { lineSliceAlong } from \"@turf/line-slice-along\";\nimport { flattenEach } from \"@turf/meta\";\nimport { featureCollection, isObject, Units } from \"@turf/helpers\";\nimport {\n  Feature,\n  FeatureCollection,\n  GeometryCollection,\n  LineString,\n  MultiLineString,\n} from \"geojson\";\n\n/**\n * Divides a {@link LineString} into chunks of a specified length.\n * If the line is shorter than the segment length then the original line is returned.\n *\n * @function\n * @param {FeatureCollection|Geometry|Feature<LineString|MultiLineString>} geojson the lines to split\n * @param {number} segmentLength how long to make each segment\n * @param {Object} [options={}] Optional parameters\n * @param {Units} [options.units='kilometers'] Supports all valid Turf {@link https://turfjs.org/docs/api/types/Units Units}\n * @param {boolean} [options.reverse=false] reverses coordinates to start the first chunked segment at the end\n * @returns {FeatureCollection<LineString>} collection of line segments\n * @example\n * var line = turf.lineString([[-95, 40], [-93, 45], [-85, 50]]);\n *\n * var chunk = turf.lineChunk(line, 15, {units: 'miles'});\n *\n * //addToMap\n * var addToMap = [chunk];\n */\nfunction lineChunk<T extends LineString | MultiLineString>(\n  geojson:\n    | Feature<T>\n    | FeatureCollection<T>\n    | T\n    | GeometryCollection\n    | Feature<GeometryCollection>,\n  segmentLength: number,\n  options: {\n    units?: Units;\n    reverse?: boolean;\n  } = {}\n): FeatureCollection<LineString> {\n  // Optional parameters\n  if (!isObject(options)) throw new Error(\"options is invalid\");\n  const { units = \"kilometers\", reverse = false } = options;\n\n  // Validation\n  if (!geojson) throw new Error(\"geojson is required\");\n  if (segmentLength <= 0) {\n    throw new Error(\"segmentLength must be greater than 0\");\n  }\n\n  // Container\n  const results: Feature<LineString>[] = [];\n\n  // Flatten each feature to simple LineString\n  flattenEach(geojson, (feature: Feature<T>) => {\n    // reverses coordinates to start the first chunked segment at the end\n    if (reverse) {\n      feature.geometry.coordinates = feature.geometry.coordinates.reverse();\n    }\n\n    sliceLineSegments(\n      feature as Feature<LineString>,\n      segmentLength,\n      units,\n      (segment) => {\n        results.push(segment);\n      }\n    );\n  });\n  return featureCollection(results);\n}\n\n/**\n * Slice Line Segments\n *\n * @private\n * @param {Feature<LineString>} line GeoJSON LineString\n * @param {number} segmentLength how long to make each segment\n * @param {Units}[units='kilometers'] Supports all valid Turf {@link https://turfjs.org/docs/api/types/Units Units}\n * @param {Function} callback iterate over sliced line segments\n * @returns {void}\n */\nfunction sliceLineSegments(\n  line: Feature<LineString>,\n  segmentLength: number,\n  units: Units,\n  callback: (feature: Feature<LineString>) => void\n): void {\n  var lineLength = length(line, { units: units });\n\n  // If the line is shorter than the segment length then the orginal line is returned.\n  if (lineLength <= segmentLength) {\n    return callback(line);\n  }\n\n  var numberOfSegments = lineLength / segmentLength;\n\n  // If numberOfSegments is integer, no need to plus 1\n  if (!Number.isInteger(numberOfSegments)) {\n    numberOfSegments = Math.floor(numberOfSegments) + 1;\n  }\n\n  for (var i = 0; i < numberOfSegments; i++) {\n    var outline = lineSliceAlong(\n      line,\n      segmentLength * i,\n      segmentLength * (i + 1),\n      { units: units }\n    );\n    callback(outline);\n  }\n}\n\nexport { lineChunk };\nexport default lineChunk;\n"],"mappings":";AAAA,SAAS,cAAc;AACvB,SAAS,sBAAsB;AAC/B,SAAS,mBAAmB;AAC5B,SAAS,mBAAmB,gBAAuB;AA4BnD,SAAS,UACP,SAMA,eACA,UAGI,CAAC,GAC0B;AAE/B,MAAI,CAAC,SAAS,OAAO,EAAG,OAAM,IAAI,MAAM,oBAAoB;AAC5D,QAAM,EAAE,QAAQ,cAAc,UAAU,MAAM,IAAI;AAGlD,MAAI,CAAC,QAAS,OAAM,IAAI,MAAM,qBAAqB;AACnD,MAAI,iBAAiB,GAAG;AACtB,UAAM,IAAI,MAAM,sCAAsC;AAAA,EACxD;AAGA,QAAM,UAAiC,CAAC;AAGxC,cAAY,SAAS,CAAC,YAAwB;AAE5C,QAAI,SAAS;AACX,cAAQ,SAAS,cAAc,QAAQ,SAAS,YAAY,QAAQ;AAAA,IACtE;AAEA;AAAA,MACE;AAAA,MACA;AAAA,MACA;AAAA,MACA,CAAC,YAAY;AACX,gBAAQ,KAAK,OAAO;AAAA,MACtB;AAAA,IACF;AAAA,EACF,CAAC;AACD,SAAO,kBAAkB,OAAO;AAClC;AAYA,SAAS,kBACP,MACA,eACA,OACA,UACM;AACN,MAAI,aAAa,OAAO,MAAM,EAAE,MAAa,CAAC;AAG9C,MAAI,cAAc,eAAe;AAC/B,WAAO,SAAS,IAAI;AAAA,EACtB;AAEA,MAAI,mBAAmB,aAAa;AAGpC,MAAI,CAAC,OAAO,UAAU,gBAAgB,GAAG;AACvC,uBAAmB,KAAK,MAAM,gBAAgB,IAAI;AAAA,EACpD;AAEA,WAAS,IAAI,GAAG,IAAI,kBAAkB,KAAK;AACzC,QAAI,UAAU;AAAA,MACZ;AAAA,MACA,gBAAgB;AAAA,MAChB,iBAAiB,IAAI;AAAA,MACrB,EAAE,MAAa;AAAA,IACjB;AACA,aAAS,OAAO;AAAA,EAClB;AACF;AAGA,IAAO,gBAAQ;","names":[]}